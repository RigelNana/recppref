{{cpp/locale/codecvt/title|out, do_out}}
{{cpp/locale/codecvt/navbar}}
{{dcl begin}}
{{dcl header|locale}}
{{dcl|num=1|1=
public:
result out( StateT&amp; state,
            const InternT* from,
            const InternT* from_end,
            const InternT*&amp; from_next,
            ExternT* to,
            ExternT* to_end,
            ExternT*&amp; to_next ) const;
}}
{{dcl|num=2|1=
protected:
virtual result do_out( StateT&amp; state,
                       const InternT* from,
                       const InternT* from_end,
                       const InternT*&amp; from_next,
                       ExternT* to,
                       ExternT* to_end,
                       ExternT*&amp; to_next ) const;
}}
{{dcl end}}

@1@ å…¬å¼€æˆå‘˜å‡½æ•°ï¼Œè°ƒç”¨æœ€ç»ˆæ´¾ç”Ÿç±»çš„æˆå‘˜å‡½æ•° {{tt|do_out}}ã€‚

@2@ å¦‚æœæ­¤ {{tt|codecvt}} åˆ»é¢å®šä¹‰äº†ä¸€ä¸ªè½¬æ¢ï¼Œé‚£ä¹ˆå°†æ¥è‡ªæºèŒƒå›´ {{range|from|from_end}} çš„å†…éƒ¨å­—ç¬¦ç¿»è¯‘åˆ°å¤–éƒ¨å­—ç¬¦ï¼Œå¹¶å°†ç»“æœç½®äºä» {{c|to}} å¼€å§‹çš„ç›¸ç»§ä½ç½®ã€‚æœ€å¤šè½¬æ¢ {{c|from_end - from}} ä¸ªå†…éƒ¨å­—ç¬¦ï¼Œæœ€å¤šå†™å…¥ {{c|to_end - to}} ä¸ªå¤–éƒ¨å­—ç¬¦ã€‚ä»¤ {{c|from_next}} å’Œ {{c|to_next}} æŒ‡å‘æœ€åæˆåŠŸè½¬æ¢å…ƒç´ çš„åä¸€ä½ç½®ã€‚

å¦‚æœæ­¤ {{tt|codecvt}} åˆ»é¢ä¸å®šä¹‰è½¬æ¢ï¼Œé‚£ä¹ˆä¸ä¼šè½¬æ¢å­—ç¬¦ã€‚è®¾ç½® {{c|to_next}} ç­‰äº {{c|to}}ï¼Œä¸æ›´æ”¹ {{c|state}}ï¼Œå¹¶è¿”å› {{lc|std::codecvt_base::noconv}}ã€‚

å¦‚æœæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼Œ{{c|do_out(state, from, from + 1, from_next, to, to_end, to_next)}} å¿…é¡»è¿”å› {{tt|ok}}ï¼š
* æ­¤ {{tt|codecvt}} åˆ»é¢ç”¨äº {{ltt|cpp/io/basic_filebuf}}ï¼Œå¹¶ä¸”
* {{c|do_out(state, from, from_end, from_next, to, to_end, to_next)}} åœ¨ {{c|1=from != from_end}} æ—¶ä¼šè¿”å› {{tt|ok}}ã€‚

===è¿”å›å€¼===
{{lc|std::codecvt_base::result}} ç±»å‹çš„å€¼ï¼ŒæŒ‰ä»¥ä¸‹æ–¹å¼æŒ‡ç¤ºæˆåŠŸçŠ¶å†µï¼š
{{dsc begin}}
{{dsc|{{tt|ok}}|è½¬æ¢å®Œæˆ}}
{{dsc|{{tt|partial}}|è¾“å‡ºç¼“å†²åŒºçš„ä¸­ç©ºé—´ä¸è¶³ï¼Œæˆ–æºç¼“å†²çš„æœªæœŸå¾…ç»“å°¾}}
{{dsc|{{tt|error}}|é‡åˆ°æ— æ³•è½¬æ¢çš„å­—ç¬¦}}
{{dsc|{{tt|noconv}}|æ­¤åˆ»é¢ä¸ä¼šè½¬æ¢ï¼Œä¸å†™å…¥è¾“å‡º}}
{{dsc end}}

æ— è½¬æ¢ç‰¹åŒ– {{c|std::codecvt&lt;char, char, std::mbstate_t&gt;}} å§‹ç»ˆè¿”å› {{lc|std::codecvt_base::noconv}}ã€‚

===æ³¨è§£===
è¦æ±‚ {{c|1=from &lt;= from_end &amp;&amp; to &lt;= to_end}} ä¸” {{c|state}} è¦ä¹ˆè¡¨ç¤ºåˆå§‹è¿ç§»çŠ¶æ€ï¼Œè¦ä¹ˆä»¥è½¬æ¢åºåˆ—ä¸­å‰è¶‹çš„å­—ç¬¦è·å¾—ã€‚

å°½ç®¡ {{tt|codecvt}} æ”¯æŒ N:M è½¬æ¢ï¼ˆä¾‹å¦‚ UTF-16 åˆ° UTF-8ï¼Œå…¶ä¸­å¯èƒ½éœ€è¦ä¸¤ä¸ªåˆå§‹å­—ç¬¦å†³å®šè¾“å‡ºçš„å¤–éƒ¨å­—ç¬¦ï¼‰ï¼Œ {{lc|std::basic_filebuf}} åªèƒ½ä½¿ç”¨å®šä¹‰ 1:N {{tt|codecvt}} è½¬æ¢çš„åˆ»é¢ï¼Œå³å®ƒåœ¨å†™å…¥æ–‡ä»¶æ—¶å¿…é¡»èƒ½å¤Ÿä¸€æ¬¡å¤„ç†ä¸€ä¸ªå†…éƒ¨å­—ç¬¦ã€‚

è¿›è¡Œ N:M è½¬æ¢æ—¶ï¼Œæ­¤å‡½æ•°å¯èƒ½åœ¨æ¶ˆè€—æ‰€æœ‰æºå­—ç¬¦åï¼ˆ{{c|1=from_next == from_end}}ï¼‰è¿”å› {{lc|std::codecvt_base::partial}}ã€‚è¿™è¡¨ç¤ºéœ€è¦å…¶ä»–å†…éƒ¨å­—ç¬¦å®Œæˆè½¬æ¢ï¼ˆä¾‹å¦‚åœ¨è½¬æ¢ UTF-16 åˆ° UTF-8 æ—¶ï¼Œå¦‚æœæºç¼“å†²åŒºä¸­çš„æœ«å­—ç¬¦æ˜¯é«˜ä½ä»£ç†ï¼‰ã€‚

{{c|state}} ä¸Šçš„æ•ˆæœæ˜¯æœ‰æ„æœªæŒ‡å®šçš„ã€‚æ ‡å‡†åˆ»é¢ä¸­ï¼Œå®ƒç”¨äºç»´æŠ¤åƒæ˜¯è°ƒç”¨ {{lc|std::wcsrtombs}} æ—¶çš„çŠ¶æ€ï¼Œä»è€Œè¢«æ›´æ–°ä¸ºåæ˜ æœ€åè¢«å¤„ç†å¤–éƒ¨å­—ç¬¦åçš„è½¬æ¢çŠ¶æ€ï¼Œä½†æ˜¯ç”¨æˆ·å®šä¹‰åˆ»é¢å¯ä»¥è‡ªç”±åœ°ç”¨å®ƒç»´æŠ¤ä»»ä½•å…¶ä»–çŠ¶æ€ï¼Œä¾‹å¦‚è®¡é‡é‡åˆ°çš„ç‰¹æ®Šå­—ç¬¦æ•°ã€‚

===ç¤ºä¾‹===
{{example
|code=
#include &lt;iostream&gt;
#include &lt;locale&gt;
#include &lt;string&gt;

int main()
{
    std::locale::global(std::locale("en_US.utf8"));
    auto&amp; f = std::use_facet&lt;std::codecvt&lt;wchar_t, char, std::mbstate_t&gt;&gt;(std::locale());
    std::wstring internal = L"z\u00df\u6c34\U0001f34c"; // L"zÃŸæ°´ğŸŒ"
    
    // æ³¨æ„ wstring_convert èƒ½åšä¸‹åˆ—å†…å®¹
    std::mbstate_t mb{}; // åˆå§‹è¿ç§»çŠ¶æ€
    std::string external(internal.size() * f.max_length(), '\0'); 
    const wchar_t* from_next;
    char* to_next;
    f.out(mb, &amp;internal[0], &amp;internal[internal.size()], from_next,
              &amp;external[0], &amp;external[external.size()], to_next);
    // ä¸ºç®€æ´èµ·è§è·³è¿‡é”™è¯¯æ£€æŸ¥
    external.resize(to_next - &amp;external[0]);
    
    std::cout &lt;&lt; "åœ¨çª„å¤šå­—èŠ‚ç¼–ç ä¸‹çš„å­—ç¬¦ä¸²ï¼š" &lt;&lt; external &lt;&lt; '\n';
}
|output=
åœ¨çª„å¤šå­—èŠ‚ç¼–ç ä¸‹çš„å­—ç¬¦ä¸²ï¼šzÃŸæ°´ğŸŒ
}}

===ç¼ºé™·æŠ¥å‘Š===
{{dr list begin}}
{{dr list item|wg=lwg|dr=76|std=C++98|before=ä¸æ˜ç¡®è½¬æ¢æ˜¯å¦éœ€è¦æ”¯æŒæ¯æ¬¡è½¬æ¢å•ä¸ªå†…éƒ¨å­—ç¬¦|after=åªæœ‰ç”¨äº {{ltt|cpp/io/basic_filebuf}} æ—¶æ‰éœ€è¦}}
{{dr list end}}

===å‚é˜…===
{{dsc begin}}
{{dsc inc|cpp/io/basic_filebuf/dsc overflow}}
{{dsc inc|cpp/locale/wstring_convert/dsc to_bytes}}
{{dsc inc|cpp/string/multibyte/dsc wcsrtombs}}
{{dsc inc|cpp/locale/codecvt/dsc do_in}}
{{dsc end}}

{{langlinks|de|en|es|fr|it|ja|pt|ru}}