{{cpp/io/basic_spanbuf/title|seekoff}}
{{cpp/io/basic_spanbuf/navbar}}
{{ddcl | since=c++23 | 1=
protected:
pos_type seekoff( off_type off, std::ios_base::seekdir dir,
                  std::ios_base::openmode which = 
                      std::ios_base::in {{!}} std::ios_base::out ) override;
}}

若可能则重寻位指向获取和/或放置区的下一位置指针，为对应于距缓冲区的获取和/或放置区的起始、末尾或当前位置恰好 {{tt|off}} 个字符的位置。

设 {{tt|''n''}} 为底层缓冲区中的 {{tt|CharT}} 元素数，或若无底层缓冲区则为 {{c|0}}，此函数在以下情况失败：
* 待重寻位的指向获取和/或放置区的下一位置指针为空，且计算的 {{tt|''newoff''}}（见后述）非零，这可能在无底层缓冲区或 {{c|*this}} 不是以 {{tt|which}} 所要求的模式打开时出现，或
* {{tt|dir}} 为 {{lc|std::ios_base::cur}} 且 {{tt|which}} 中一同设置了 {{lc|std::ios_base::in}} 和 {{lc|std::ios_base::out}}，或
* 计算的 {{tt|''newoff''}} 无法以 {{tt|off_type}} 表示、小于零或大于 {{tt|''n''}}。

{{tt|''newoff''}} 计算如下：
* 若 {{tt|dir}} 为 {{lc|std::ios_base::beg}}，则 {{tt|''newoff''}} 为 {{tt|off}}。
* 若 {{tt|dir}} 为 {{lc|std::ios_base::cur}}，则 {{tt|''newoff''}}
** 若 {{tt|which}} 中设置了 {{lc|std::ios_base::out}}，则为 {{c|pptr() - pbase() + off}}，或
** 若 {{tt|which}} 中设置了 {{lc|std::ios_base::in}}，则为 {{c|gptr() - eback() + off}}。
* 若 {{tt|dir}} 为 {{lc|std::ios_base::end}}，则 {{tt|''newoff''}}
** 若 {{c|*this}} 的打开模式中设置了 {{lc|std::ios_base::out}} 但非 {{lc|std::ios_base::in}}，则为 {{c|pptr() - pbase() + off}}，
** 否则为 {{c|off + n}}。

若在 {{tt|which}} 中相应地设置了 {{lc|std::ios_base::in}} 和/或 {{lc|std::ios_base::out}}，则此函数在成功时重寻位指向获取和/或放置区的下一位置指针为 {{c|pbuf + newoff}}，其中 {{tt|''pbuf''}} 是指向底层缓冲区的指针，或若无底层缓冲区则为空指针值。

===参数===
{{par begin}}
{{par | off |要设置下一位置指针到的相对位置}}
{{par | dir |定义应用偏移量的基位置。它可为下列常量之一：
{{cpp/io/ios_base/seekdir consts}} }}
{{par | which |定义所影响的是输入序列、输出序列还是两者。它可为下列常量之一或其组合：
{{cpp/io/ios_base/openmode streambuf consts}} }}
{{par end}}

===返回值===
成功时为 {{c|pos_type(newoff)}}，失败时为 {{c|pos_type(off_type(-1))}}。

===示例===
{{example}}

===参阅===
{{dsc begin}}
{{dsc inc | cpp/io/basic_stringbuf/dsc seekoff}}
{{dsc inc | cpp/io/strstreambuf/dsc seekoff}}
{{dsc end}}

{{langlinks|de|en|es|fr|it|ja|pt|ru}}