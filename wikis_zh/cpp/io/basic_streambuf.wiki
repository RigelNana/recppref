{{cpp/title|basic_streambuf}}
{{cpp/io/basic_streambuf/navbar}}
{{ddcl|header=streambuf|1=
template&lt; 
    class CharT, 
    class Traits = std::char_traits&lt;CharT&gt;
&gt; class basic_streambuf;
}}

类 {{tt|basic_streambuf}} 控制字符序列的输入与输出。它包含下列内容并提供到它们的访问：

# ''受控制字符序列''，又称为''缓冲区''，它可含有为输入操作缓冲的''输入序列''（又称为''获取区''），和/或为输出操作缓冲的''输出序列''（又称为''放置区''）。
# ''关联字符序列''，又称作''源''（对于输入）或''池''（对于输出）。它可以是通过操作系统 API 访问的实体（文件、TCP 套接字、串行端口、其他字符设备），或者可以是能解读成字符源或池的对象（{{lc|std::vector}}、[[cpp/language/array|数组]]、[[cpp/language/string literal|字符串字面量]]）。

输入/输出流对象 {{lc|std::basic_istream}} 及 {{lc|std::basic_ostream}}，还有所有派生自它们的对象（{{lc|std::ofstream}}、{{lc|std::stringstream}} 等），都完全以 {{tt|std::basic_streambuf}} 实现。

受控制字符序列是 {{tt|CharT}} 的数组，它在所有时候都表示关联字符序列的子序列，或其中的“窗口”。它的状态以三个指针描述：
# ''起始指针'' ，始终指向缓冲的最低元素。
# ''下一位置指针'' ，指向读或写的下个候选元素。
# ''终止指针'' ，指向缓冲区尾后一个位置。

{{tt|basic_streambuf}} 对象可以支持输入（此时起始、下一位置和终止指针所描述的区域被称为''获取区''）、输出（''放置区''），或同时输入与输出。在最后一种情况下，它跟踪六个指针，它们可能全部指向同一数组的元素，或指向两个单独数组的元素。

如果放置区中下一位置指针小于终止指针，那么 ''写位置'' 可用。下一位置指针可被解引用和赋值。

如果获取区中下一位置指针小于终止指针，那么 ''读位置'' 可用。下一位置指针可被解引用和读取。

如果获取区中下一位置指针大于起始指针，那么 ''回放位置'' 可用，而下一位置指针可以被自减并赋值，以将字符放回到获取区。

受控制序列中的字符表示和编码可以异于关联序列中的字符表示，该情况下通常用 {{lc|std::codecvt}} 本地环境刻面进行转换。常见的例子是通过 {{lc|std::wfstream}} 对象访问 UTF-8（或其他多字节编码）文件：受控制字符序列由 {{c/core|wchar_t}} 字符组成，但关联序列由字节组成。

{{tt|std::basic_streambuf}} 基类的典型实现只保有六个 {{tt|CharT*}} 指针和一个 {{lc|std::locale}} 副本作为数据成员。另外，实现可以保持缓存的本地环境刻面，凡调用 {{tt|imbue()}} 时便使之失效。具体的缓冲类，如 {{lc|std::basic_filebuf}} 或 {{lc|std::basic_stringbuf}} 均派生自 {{tt|std::basic_streambuf}}。

{{image|std-streambuf.svg}}

{{cpp/basic char typedefs|streambuf}}

{{cpp/io/member types}}

===成员函数===
{{dsc begin}}
{{dsc inc | cpp/io/basic_streambuf/dsc ~basic_streambuf}}

{{dsc h2 |本地环境}}
{{dsc inc | cpp/io/basic_streambuf/dsc pubimbue}}
{{dsc inc | cpp/io/basic_streambuf/dsc getloc}}

{{dsc h2 |寻位}}
{{dsc inc | cpp/io/basic_streambuf/dsc pubsetbuf}}
{{dsc inc | cpp/io/basic_streambuf/dsc pubseekoff}}
{{dsc inc | cpp/io/basic_streambuf/dsc pubseekpos}}
{{dsc inc | cpp/io/basic_streambuf/dsc pubsync}}

{{dsc h2 |获取区}}
{{dsc inc | cpp/io/basic_streambuf/dsc in_avail}}
{{dsc inc | cpp/io/basic_streambuf/dsc snextc}}
{{dsc inc | cpp/io/basic_streambuf/dsc sbumpc}}
{{dsc inc | cpp/io/basic_streambuf/dsc sgetc}}
{{dsc inc | cpp/io/basic_streambuf/dsc sgetn}}

{{dsc h2 |放置区}}
{{dsc inc | cpp/io/basic_streambuf/dsc sputc}}
{{dsc inc | cpp/io/basic_streambuf/dsc sputn}}

{{dsc h2 |回放}}
{{dsc inc | cpp/io/basic_streambuf/dsc sputbackc}}
{{dsc inc | cpp/io/basic_streambuf/dsc sungetc}}

{{dsc h1 |受保护成员函数}}
{{dsc inc | cpp/io/basic_streambuf/dsc basic_streambuf}}
{{dsc inc | cpp/io/basic_streambuf/dsc operator{{=}}}}
{{dsc inc | cpp/io/basic_streambuf/dsc swap}}

{{dsc h2 |本地环境}}
{{dsc inc | cpp/io/basic_streambuf/dsc imbue}}

{{dsc h2 |寻位}}
{{dsc inc | cpp/io/basic_streambuf/dsc setbuf}}
{{dsc inc | cpp/io/basic_streambuf/dsc seekoff}}
{{dsc inc | cpp/io/basic_streambuf/dsc seekpos}}
{{dsc inc | cpp/io/basic_streambuf/dsc sync}}

{{dsc h2 |获取区}}
{{dsc inc | cpp/io/basic_streambuf/dsc showmanyc}}
{{dsc inc | cpp/io/basic_streambuf/dsc underflow}}
{{dsc inc | cpp/io/basic_streambuf/dsc uflow}}
{{dsc inc | cpp/io/basic_streambuf/dsc xsgetn}}
{{dsc inc | cpp/io/basic_streambuf/dsc gptr}}
{{dsc inc | cpp/io/basic_streambuf/dsc gbump}}
{{dsc inc | cpp/io/basic_streambuf/dsc setg}}

{{dsc h2 |放置区}}
{{dsc inc | cpp/io/basic_streambuf/dsc xsputn}}
{{dsc inc | cpp/io/basic_streambuf/dsc overflow}}
{{dsc inc | cpp/io/basic_streambuf/dsc pptr}}
{{dsc inc | cpp/io/basic_streambuf/dsc pbump}}
{{dsc inc | cpp/io/basic_streambuf/dsc setp}}

{{dsc h2 |回放}}
{{dsc inc | cpp/io/basic_streambuf/dsc pbackfail}}
{{dsc end}}

===参阅===
{{dsc begin}}
{{dsc inc | cpp/io/c/dsc FILE}}
{{dsc end}}

{{langlinks|de|en|es|fr|it|ja|pt|ru}}