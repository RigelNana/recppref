{{cpp/title|vprint_unicode{{small|(std::ostream)}}}}
{{cpp/io/basic_ostream/navbar}}
{{dcl begin}}
{{dcl header|ostream}}
{{dcl|since=c++23|1=
void vprint_unicode( std::ostream&amp; os,
                     std::string_view fmt, std::format_args args );
}}
{{dcl end}}

根据格式字符串 {{c|fmt}} 格式化 {{c|args}}，并将结果写入输出流 {{c|os}}。表现为{{named req|FormattedOutputFunction}}（除了错误报告的一些细节[[#异常|有所不同]]）。

按顺序执行以下操作：
# 构造并检查 {{rlp|sentry}} 对象。
# 如同以 {{c|1=std::string out = std::vformat(os.getloc(), fmt, args);}} 初始化一个自动变量。
# 将 {{c|out}} 写入 {{c|os}}：
:* 如果 {{c|os}} 指代的终端仅可通过[[cpp/io/vprint_unicode#注解|原生 Unicode API]] 显示 Unicode，那么冲洗 {{c|os}} 并使用原生 Unicode API 将 {{c|out}} 写入该终端。
:* 否则，将字符序列 {{range|out.begin()|out.end()}} 插入 {{c|os}}。

如果写入终端或插入 {{c|os}} 失败，那么就会调用 {{c|os.setstate(std::ios_base::badbit)}}。

{{rrev|since=c++26|
在向 {{c|os}} 写入字符后建立一个[[cpp/language/as if|可观察检查点]]。
}}

在使用原生 Unicode API 的情况下，如果 {{c|out}} 包含了无效 Unicode {{enwiki|Character encoding#Terminology|代码单元}}，那么行为未定义。

===参数===
{{par begin}}
{{par|os|要插入数据的输出流}}
{{par|fmt|{{include|cpp/utility/format/format string}}}}
{{par|args|要格式化的实参}}
{{par end}}

===异常===
{{std print ostream exceptions}}

===注解===
如果调用原生 Unicode API 需要进行转码，那么无效代码单元都会被替换成 {{tt|U+FFFD}} REPLACEMENT CHARACTER（参见《Unicode 标准 - 核心规范》，[[#外部链接|章节 3.9]]）。

{{ftm begin|std=1|value=1|comment=1}}
{{ftm|std=C++23|value=202207L|__cpp_lib_print|格式化输出}}
{{ftm|std=C++23|value=202207L|__cpp_lib_format|暴露 {{lc|std::basic_format_string}}}}
{{ftm end}}

===示例===
{{example
|code=
|output=
}}

===缺陷报告===
{{dr list begin}}
{{dr list item|wg=lwg|dr=4044|std=C++23|before=只要 {{c|os}} 指代的终端能显示 Unicode，&lt;br&gt;就会使用原生 Unicode API|after=只有在终端仅可通过原生 Unicode API&lt;br&gt;显示 Unicode 时才会使用}}
{{dr list end}}

===参阅===
{{dsc begin}}
{{dsc inc|cpp/io/basic_ostream/dsc vprint_nonunicode}}
{{dsc inc|cpp/io/basic_ostream/dsc print}}
{{dsc inc|cpp/io/basic_ostream/dsc operator ltlt2}}
{{dsc inc|cpp/io/dsc vprint_unicode}}
{{dsc inc|cpp/utility/format/dsc format}}
{{dsc end}}

===外部链接===
{{elink begin}}
{{elink|{{enwiki|Unicode|Unicode &amp;mdash; Wikipedia}}}}
{{elink|[https://www.unicode.org/versions/Unicode14.0.0/UnicodeStandard-14.0.pdf Unicode 标准，版本 14.0 &amp;mdash; 核心规范]}}
{{elink end}}

{{langlinks|de|es|fr|ja|ru|zh}}