{{cpp/io/basic_filebuf/title |seekoff}}
{{cpp/io/basic_filebuf/navbar}}
{{ddcl |1=
protected:
virtual pos_type seekoff( off_type off,
                          std::ios_base::seekdir dir,
                          std::ios_base::openmode which = std::ios_base::in {{!}} std::ios_base::out );
}}

åœ¨å¯èƒ½æ—¶é‡å¯»ä½æ–‡ä»¶æŒ‡é’ˆåˆ°è·æ–‡ä»¶èµ·å§‹ã€ç»“å°¾æˆ–å½“å‰ä½ç½®æ°å¥½ {{c|off}} ä¸ªå­—ç¬¦çš„ä½ç½®ï¼ˆå–å†³äº {{c|dir}} çš„å€¼ï¼‰ã€‚

å…³è”æ–‡ä»¶æœªæ‰“å¼€ï¼ˆ{{c|1=is_open() == false}}ï¼‰æ—¶ç«‹å³å¤±è´¥ã€‚

å¦‚æœå¤šå­—èŠ‚å­—ç¬¦ç¼–ç ä¾èµ–çŠ¶æ€ï¼ˆ{{ltt|cpp/locale/codecvt/encoding|codecvt::encoding()}} è¿”å› {{c|-1}}ï¼‰æˆ–è€…æ˜¯å˜é•¿çš„ï¼ˆ{{tt|codecvt::encoding()}} è¿”å› {{c|0}}ï¼‰ï¼Œè€Œåç§» {{c|off}} é {{c|0}}ï¼Œé‚£ä¹ˆç«‹å³å¤±è´¥ï¼šæ­¤å‡½æ•°æ— æ³•ç¡®å®šå¯¹åº” {{c|off}} ä¸ªå­—ç¬¦çš„å­—èŠ‚æ•°ã€‚

å¦‚æœ {{c|dir}} ä¸æ˜¯ {{lc|std::basic_ios::cur}} æˆ–åç§» {{c|off}} é {{c|0}}ï¼Œå¹¶ä¸”æ­¤ filebuf å¯¹è±¡ä¸Šæœ€è¿‘åšçš„æ“ä½œæ˜¯è¾“å‡ºï¼ˆå³æ”¾ç½®ç¼“å†²åŒºéç©ºï¼Œæˆ–æœ€è¿‘è°ƒç”¨çš„å‡½æ•°æ˜¯ {{lc|overflow()}}ï¼‰ï¼Œé‚£ä¹ˆå°±ä¼šè°ƒç”¨ {{c|std::codecvt::unshift}} ä»¥ç¡®å®šéœ€è¦çš„åè¿ç§»åºåˆ—ï¼Œå¹¶é€šè¿‡è°ƒç”¨ {{lc|overflow()}} å°†è¯¥åºåˆ—å†™å…¥æ–‡ä»¶ã€‚

ç„¶åè½¬æ¢å®å‚ {{c|dir}} åˆ° {{c|int}} ç±»å‹å€¼ {{c|whence}} å¦‚ä¸‹ï¼š

{{dsc begin}}
{{dsc hitem |{{c|dir}} çš„å€¼|{{c|whence}} çš„å€¼}}
{{dsc|{{c|std::basic_ios::beg}}|{{lc|SEEK_SET}}}}
{{dsc|{{c|std::basic_ios::end}}|{{lc|SEEK_END}}}}
{{dsc|{{c|std::basic_ios::cur}}|{{lc|SEEK_CUR}}}}
{{dsc end}}

ç„¶åï¼Œå¦‚æœå­—ç¬¦ç¼–ç æ˜¯å®šå®½çš„{{tt|codecvt::encoding()}} è¿”å›æŸä¸ªæ­£å€¼ {{c|width}}ï¼‰ï¼Œé‚£ä¹ˆå¦‚åŒç”¨ {{c|std::fseek(file, width*off, whence)}} ç§»åŠ¨æ–‡ä»¶æŒ‡é’ˆã€‚

å¦åˆ™ï¼Œå¦‚åŒç”¨ {{c|std::fseek(file, 0, whence)}} ç§»åŠ¨æ–‡ä»¶æŒ‡é’ˆã€‚

åŸºç±»å‡½æ•°ç­¾åè¦æ±‚çš„ {{tt|openmode}} å®å‚é€šå¸¸ä¼šè¢«å¿½ç•¥ï¼Œå› ä¸º {{tt|std::basic_filebuf}} åªç»´æŠ¤ä¸€ä¸ªæ–‡ä»¶ä½ç½®ã€‚

===å‚æ•°===
{{par begin}}
{{par|off|è¦è®¾ç½®ä½ç½®æŒ‡ç¤ºå™¨åˆ°çš„ç›¸å¯¹ä½ç½®ã€‚}}
{{par|dir|å®šä¹‰è¦åº”ç”¨ç›¸å¯¹åç§»åˆ°çš„åŸºä½ç½®ã€‚å®ƒå¯ä»¥æ˜¯ä¸‹åˆ—å¸¸é‡ä¹‹ä¸€ï¼š
{{cpp/io/ios_base/seekdir consts}}}}
{{par|which|å®šä¹‰ä¼šå½±å“åˆ°çš„è¾“å…¥å’Œ/æˆ–è¾“å‡ºåºåˆ—ã€‚å®ƒå¯ä»¥æ˜¯ä¸‹åˆ—å¸¸é‡ä¹‹ä¸€æˆ–å®ƒä»¬çš„ç»„åˆï¼š
{{cpp/io/ios_base/openmode streambuf consts}}}}
{{par end}}

===è¿”å›å€¼===
æ–°æ„é€ çš„ {{c|pos_type}} ç±»å‹å¯¹è±¡ï¼Œå­˜å‚¨ç»“æœæ–‡ä»¶ä½ç½®ï¼Œæˆ–åœ¨å¤±è´¥æ—¶è¿”å› {{c|pos_type(off_type(-1))}}ã€‚

===æ³¨è§£===
{{tt|seekoff()}} ä¼šè¢« {{c|std::basic_streambuf::pubseekoff}} è°ƒç”¨ï¼Œå®ƒåˆä¼šè¢« {{c|std::basic_istream::seekg}}ã€{{c|std::basic_ostream::seekp}}ã€{{c|std::basic_istream::tellg}} å’Œ {{c|std::basic_ostream::tellp}} è°ƒç”¨ã€‚

===ç¤ºä¾‹===
{{example
|code=
#include &lt;fstream&gt;
#include &lt;iostream&gt;
#include &lt;locale&gt;

template&lt;typename CharT&gt;
int get_encoding(const std::basic_istream&lt;CharT&gt;&amp; stream)
{
    using Facet = std::codecvt&lt;CharT, char, std::mbstate_t&gt;;
    return std::use_facet&lt;Facet&gt;(stream.getloc()).encoding();
}

int main()
{
    // å‡†å¤‡ 10 å­—èŠ‚æ–‡ä»¶ï¼Œä¿æœ‰ 4 ä¸ª UTF-8 ä¸­çš„å­—ç¬¦ï¼ˆ"zÃŸæ°´ğ„‹"ï¼‰
    std::ofstream("text.txt") &lt;&lt; "\x7a\xc3\x9f\xe6\xb0\xb4\xf0\x9d\x84\x8b";
    
    // ç”¨éè½¬æ¢ç¼–ç æ‰“å¼€
    std::ifstream f1("text.txt");
    std::cout &lt;&lt; "f1 çš„æœ¬åœ°ç¯å¢ƒçš„ encoding() è¿”å› "
              &lt;&lt; get_encoding(f1) &lt;&lt; '\n'
              &lt;&lt; "pubseekoff(3, beg) è¿”å› "
              &lt;&lt; f1.rdbuf()-&gt;pubseekoff(3, std::ios_base::beg) &lt;&lt; '\n'
              &lt;&lt; "pubseekoff(0, end) è¿”å› "
              &lt;&lt; f1.rdbuf()-&gt;pubseekoff(0, std::ios_base::end) &lt;&lt; '\n';
    
    // ç”¨ UTF-8 æ‰“å¼€
    std::wifstream f2("text.txt");
    f2.imbue(std::locale("en_US.UTF-8"));
    std::cout &lt;&lt; "f2 çš„æœ¬åœ°ç¯å¢ƒçš„ encoding() è¿”å› "
              &lt;&lt; get_encoding(f2) &lt;&lt; '\n'
              &lt;&lt; "pubseekoff(3, beg) è¿”å› "
              &lt;&lt; f2.rdbuf()-&gt;pubseekoff(3, std::ios_base::beg) &lt;&lt; '\n'
              &lt;&lt; "pubseekoff(0, end) è¿”å› "
              &lt;&lt; f2.rdbuf()-&gt;pubseekoff(0, std::ios_base::end) &lt;&lt; '\n';
}
|output=
f1 çš„æœ¬åœ°ç¯å¢ƒçš„ encoding() è¿”å› 1
pubseekoff(3, beg) è¿”å› 3
pubseekoff(0, end) è¿”å› 10
f2 çš„æœ¬åœ°ç¯å¢ƒçš„ encoding() è¿”å› 0
pubseekoff(3, beg) è¿”å› -1
pubseekoff(0, end) è¿”å› 10
}}

===ç¼ºé™·æŠ¥å‘Š===
{{dr list begin}}
{{dr list item|wg=lwg|dr=55|std=C++98|before={{tt|seekoff}} åœ¨å¤±è´¥æ—¶è¿”å›äº†æœªå®šä¹‰çš„æ— æ•ˆæµä½ç½®|after=å¤±è´¥æ—¶è¿”å› {{c|pos_type(off_type(-1))}}}}
{{dr list end}}

===å‚é˜…===
{{dsc begin}}
{{dsc inc|cpp/io/basic_streambuf/dsc pubseekoff}}
{{dsc inc|cpp/io/basic_filebuf/dsc seekpos}}
{{dsc inc|cpp/io/c/dsc fseek}}
{{dsc end}}

{{langlinks|de|en|es|fr|it|ja|pt|ru}}