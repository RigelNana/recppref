{{cpp/memory/monotonic_buffer_resource/title|do_allocate}}
{{cpp/memory/monotonic_buffer_resource/navbar}}
{{ddcl|since=c++17|1=
virtual void* do_allocate( std::size_t bytes, std::size_t alignment );
}}

分配存储。

若''当前缓冲区''有足够的未使用空间以适合一个拥有指定大小和对齐的块，则从当前缓冲区分配返回的块。

否则，此函数通过调用 {{c|upstream_resource()-&gt;allocate(n, m)}} 分配新缓冲区，其中 {{tt|n}} 不小于{{c|bytes}} 与''下个缓冲区大小''的较大者，且 {{tt|m}} 不小于 {{c|alignment}}。它设置新缓冲区为''当前缓冲区''，以实现定义的增长因子（不必是整数）增加''下个缓冲区大小''，然后从新分配的缓冲区分配返回块。

=== 返回值 ===
指向至少 {{c|bytes}} 字节大小的指针，若支持该对齐则对齐到指定的 {{c|alignment}}，否则对齐到 {{c|alignof(std::max_align_t)}}。

=== 异常 ===
不抛出任何异常，除非上游内存资源的 {{tt|allocate()}} 抛出。

=== 参阅 ===
{{dsc begin}}
{{dsc inc|cpp/memory/memory_resource/dsc allocate}}
{{dsc inc|cpp/memory/memory_resource/dsc do_allocate}}
{{dsc end}}

{{langlinks|en|es|ja|ru}}