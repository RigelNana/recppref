{{cpp/title|formatter{{small|&lt;std::chrono::zoned_time&gt;}}|{{small|chrono::}}local_time_format}}
{{cpp/chrono/zoned_time/navbar}}

{{dcl begin}}
{{dcl header|chrono}}
{{dcl|num=1|since=c++20|
template&lt; class Duration, class TimeZonePtr, class CharT &gt;
struct formatter&lt;std::chrono::zoned_time&lt;Duration, TimeZonePtr&gt;, CharT&gt;
    : std::formatter&lt;/*local-time-format-t*/
                         &lt;std::common_type_t&lt;Duration,
                                             std::chrono::seconds&gt;&gt;, CharT&gt;
}}
{{dcl|num=2|since=c++20|1=
template&lt; class Duration &gt;
/*local-time-format-t*/&lt;Duration&gt;
    local_time_format( const std::chrono::local_time&lt;Duration&gt;&amp; tp,
                       const std::string* abbrev = nullptr,
                       const std::chrono::seconds* offset_sec = nullptr );
}}
{{dcl h|辅助模板}}
{{dcla|num=3|since=c++20|expos=yes|
template&lt; class Duration &gt;
struct /*local-time-format-t*/
{
    std::chrono::local_time&lt;Duration&gt; /*time*/;
    const std::string* /*abbrev*/;
    const std::chrono::seconds* /*offset_sec*/;
};
}}
{{dcl|num=4|since=c++20|
template&lt; class Duration, class CharT &gt;
struct formatter&lt;/*local-time-format-t*/&lt;Duration&gt;, CharT&gt;;
}}
{{dcl end}}

@1@ {{lc|std::formatter}} 的特化，定义 {{lc|std::chrono::zoned_time}} 的格式化规则。
* 它的 {{tt|parse}} 成员从基类继承。
* 设 {{c|tp}} 为格式化实参，{{c|ctx}} 为格式化上下文，它的 {{tt|format}} 成员的行为等价于：
{{box|
{{c/core|1=using common_duration_type = std::common_type_t&lt;Duration, std::chrono::seconds&gt;;}}&lt;br&gt;
{{c/core|1=using formatter_type = std::formatter&lt;}}{{tti|local-time-format-t}}{{sep}}{{c/core|&lt;common_duration_type&gt;;}}&lt;br&gt;&lt;br&gt;
{{c/core|1=std::chrono::sys_info info = tp.get_info();}}&lt;br&gt;
{{c/core|return formatter_type::format({tp.get_local_time(), &amp;info.abbrev, &amp;info.offset_sec}), ctx);}}
}}

@2@ 创建一个对象，它可以作为 {{lc|std::chrono::zoned_time}} 格式化。
@@ 返回 {{c|{time, abbrev, offset_sec}&lt;!----&gt;}}。

@3@ 一个仅用于阐述的类型，它包含格式化 {{lc|std::chrono::zoned_time}} 所需的所有信息：
* {{tti|abbrev}} 包含时区简称。
* {{tti|offset_sec}} 包含 UTC 偏移量。
* {{tti|time}} 包含需要的所有其他信息。

@4@ {{lc|std::formatter}} 的特化，定义 {{lc|std::chrono::zoned_time}} 的底层格式化规则。
@@ 设 {{c|f}} 为格式化实参，该特化具有下列额外格式化规则：
* 如果省略{{spar|时间说明}}，那么结果等价于使用 {{ttb|%F %T %Z}} 作为{{spar sep|时间说明}}。
* 如果使用了 {{ttb|%Z}}，那么当 {{c|f.abbrev}} 不是空指针值时将该说明符替换成 {{c|*f.abbrev}}；否则抛出 {{lc|std::format_error}} 类型的异常。
* 如果使用了 {{ttb|%z}} 或 {{ttb|%z}} 的有修饰变体，那么当 {{c|f.offset_sec}} 不是空指针值时将该说明符替换成 {{c|*f.offset_sec}}；否则抛出 {{lc|std::format_error}} 类型的异常。

通常不直接访问，但通过[[cpp/utility/format|格式化函数]]使用 {{lc|std::formatter}} 特化。

===格式说明===
{{cpp/chrono/format spec}}

===示例===
{{example}}

===缺陷报告===
{{dr list begin}}
{{dr list item|wg=lwg|dr=4124|std=C++20|before=1. 不能省略{{spar|时间说明}}&lt;br&gt;2. 不能用比秒粗的分辨率格式化 {{tt|zoned_time}}|after=1. 可以省略&lt;br&gt;2. 可以以这些分辨率格式化}}
{{dr list item|paper=P2372R3|std=C++20|before={{tt|formatter}} 使用全局本地环境或传递的本地环境|after=在缺少 {{ttb|L}} 时则使用默认 {{c|"C"}} 本地环境}}
{{dr list end}}

===参阅===
{{dsc begin}}
{{dsc inc|cpp/utility/format/dsc format}}
{{dsc end}}

{{langlinks|de|en|es|ja|ru}}