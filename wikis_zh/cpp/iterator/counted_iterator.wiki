{{cpp/title|counted_iterator}}
{{cpp/iterator/counted_iterator/navbar}}
{{ddcl|header=iterator|since=c++20|1=
template&lt; std::input_or_output_iterator I &gt;
class counted_iterator;
}}

{{tt|std::counted_iterator}} 是一种迭代器适配器，其表现与其底层迭代器严格相同，但它保持跟踪到范围末尾的距离。当且仅当其计数抵达零时，这种迭代器等于 {{lc|std::default_sentinel_t|std::default_sentinel}}。

===成员类型===
{{dsc begin}}
{{dsc hitem|成员类型|定义}}
{{dsc|{{tt|iterator_type}}|{{tt|I}}}}
{{dsc|{{tt|value_type}}&lt;br&gt;{{mark cond present}}|若 {{tt|I}} 实现 {{lconcept|indirectly_readable}} 则为 {{c/core|std::iter_value_t&lt;I&gt;}}；否则不定义}}
{{dsc|{{tt|difference_type}}|{{c/core|std::iter_difference_t&lt;I&gt;}} }}
{{dsc|{{tt|iterator_concept}}&lt;br&gt;{{mark cond present}}|若 {{c/core|I::iterator_concept}} 存在则为它；否则不定义}}
{{dsc|{{tt|iterator_category}}&lt;br&gt;{{mark cond present}}|若 {{c/core|I::iterator_category}} 存在则为它；否则不定义}}
{{dsc end}}

===成员对象===
{{dsc begin}}
{{dsc hitem|成员名|定义}}
{{dsc|{{tti|current}} {{mark|私有}}|{{rlt|base|base()}} 所访问的底层迭代器&lt;br&gt;{{mark expos mem obj}}}}
{{dsc|{{tti|length}} {{mark|私有}}|底层迭代器与其范围末尾的距离&lt;br&gt;{{mark expos mem obj}}}}
{{dsc end}}

===成员函数===
{{dsc begin}}
{{dsc inc|cpp/iterator/adaptor/dsc constructor|counted_iterator}}
{{dsc inc|cpp/iterator/adaptor/dsc operator{{=}}|counted_iterator}}
{{dsc inc|cpp/iterator/adaptor/dsc base|counted_iterator}}
{{dsc inc|cpp/iterator/counted_iterator/dsc count}}
{{dsc inc|cpp/iterator/adaptor/dsc operator*|counted_iterator}}
{{dsc inc|cpp/iterator/adaptor/dsc operator_at|counted_iterator}}
{{dsc inc|cpp/iterator/adaptor/dsc operator_arith|counted_iterator}}
{{dsc end}}

===非成员函数===
{{dsc begin}}
{{dsc inc|cpp/iterator/adaptor/dsc operator_cmp|counted_iterator}}
{{dsc inc|cpp/iterator/counted_iterator/dsc operator_cmp2}}
{{dsc inc|cpp/iterator/adaptor/dsc operator+|counted_iterator}}
{{dsc inc|cpp/iterator/adaptor/dsc operator-|counted_iterator}}
{{dsc inc|cpp/iterator/counted_iterator/dsc operator-2}}
{{dsc inc|cpp/iterator/adaptor/dsc iter_move|counted_iterator}}
{{dsc inc|cpp/iterator/adaptor/dsc iter_swap|counted_iterator}}
{{dsc end}}

===辅助类===
{{dsc begin}}
{{dsc inc|cpp/iterator/counted_iterator/dsc iterator_traits}}
{{dsc end}}

===示例===
{{example
|code=
#include &lt;algorithm&gt;
#include &lt;iostream&gt;
#include &lt;iterator&gt;
#include &lt;string&gt;
#include &lt;vector&gt;

using std::operator""s;

void print(auto const remark, auto const&amp; v)
{
    const auto size = std::ssize(v);
    std::cout &lt;&lt; remark &lt;&lt; '[' &lt;&lt; size &lt;&lt; "] { ";
    for (auto it = std::counted_iterator{std::cbegin(v), size};
         it != std::default_sentinel; ++it)
        std::cout &lt;&lt; *it &lt;&lt; (it.count() &gt; 1 ? ", " : " ");
    std::cout &lt;&lt; "}\n";
}

int main()
{
    const auto src = {"Arcturus"s, "Betelgeuse"s, "Canopus"s, "Deneb"s, "Elnath"s};
    print("src", src);
    std::vector&lt;decltype(src)::value_type&gt; dst;
    std::ranges::copy(std::counted_iterator{src.begin(), 3},
                      std::default_sentinel,
                      std::back_inserter(dst));
    print("dst", dst);
}
|output=
src[5] { Arcturus, Betelgeuse, Canopus, Deneb, Elnath }
dst[3] { Arcturus, Betelgeuse, Canopus }
}}

===缺陷报告===
{{dr list begin}}
{{dr list item|paper=P2259R1|std=C++20|before=不提供成员 typedef&lt;br&gt;对 {{tt|counted_iterator}} 特化 {{lc|std::incrementable_traits}}|after=添加成员 typedef 以顾及 {{ltt|cpp/iterator/counted_iterator/iterator_traits}} 修正&lt;br&gt;移除了冗余的 {{lc|std::incrementable_traits}} 特化}}
{{dr list end}}

===参阅===
{{dsc begin}}
{{dsc inc|cpp/iterator/dsc default_sentinel_t}}
{{dsc inc|cpp/ranges/dsc view_counted}}
{{dsc inc|cpp/ranges/dsc take_view}}
{{dsc end}}

{{langlinks|cs|de|en|es|fr|it|ja|ko|pl|pt|ru}}