{{cpp/title|mbrtoc16}}
{{cpp/string/multibyte/navbar}}
{{ddcl|header=cuchar|since=c++11|
std::size_t mbrtoc16( char16_t* pc16, const char* s,
                      std::size_t n, std::mbstate_t* ps );
}}

è½¬æ¢çª„å¤šå­—èŠ‚å­—ç¬¦åˆ°å…¶ UTF-16 å­—ç¬¦è¡¨ç¤ºã€‚

è‹¥ {{c|s}} ä¸æ˜¯ç©ºæŒ‡é’ˆï¼Œåˆ™å®¡æŸ¥ä» {{c|s}} æ‰€æŒ‡çš„å­—èŠ‚å¼€å§‹çš„å¤šå­—èŠ‚å­—ç¬¦ä¸²çš„è‡³å¤š {{c|n}} ä¸ªå­—èŠ‚ï¼Œä»¥æ£€æŸ¥å®Œæˆä¸‹ä¸ªå¤šå­—èŠ‚å­—ç¬¦çš„å­—èŠ‚æ•°ï¼ˆåŒ…å«ä»»ä½•è¿ç§»åºåˆ—ï¼‰ã€‚è‹¥å‡½æ•°ç¡®å®š {{c|s}} ä¸­ä¸‹ä¸ªå¤šå­—èŠ‚å­—ç¬¦å®Œæ•´ä¸”åˆæ³•ï¼Œåˆ™å°†å®ƒè½¬æ¢åˆ°å¯¹åº”çš„ 16 ä½å®½å­—ç¬¦ï¼Œå¹¶å°†å®ƒå­˜å‚¨äº {{c|*pc16}}ï¼ˆè‹¥ {{tt|pc16}} éç©ºï¼‰ã€‚

è‹¥ {{c|*s}} ä¸­çš„å®½å­—ç¬¦å¯¹åº”å¤š {{c/core|char16_t}} çš„åºåˆ—ï¼ˆä¾‹å¦‚ UTF-16 ä¸­çš„ä»£ç†å¯¹ï¼‰ï¼Œåˆ™åœ¨é¦–æ¬¡è°ƒç”¨æ­¤å‡½æ•°åæ›´æ–° {{c|*ps}}ï¼Œä»¥ä»¤ä¸‹æ¬¡åˆ° {{tt|mbrtoc16}} çš„è°ƒç”¨å°†å†™å‡ºé¢å¤–çš„ {{c/core|char16_t}}ï¼Œè€Œä¸è€ƒè™‘ {{c|*s}}ã€‚

è‹¥ {{c|s}} æ˜¯ç©ºæŒ‡é’ˆï¼Œåˆ™å¿½ç•¥ {{c|n}} ä¸ {{c|pc16}} çš„å€¼ï¼Œè€Œè°ƒç”¨ç­‰ä»·äº {{c|std::mbrtoc16(NULL, "", 1, ps)}}ã€‚

è‹¥äº§ç”Ÿçš„å®½å­—ç¬¦æ˜¯ç©ºå­—ç¬¦ï¼Œåˆ™è½¬æ¢çŠ¶æ€ {{c|*ps}} è¡¨ç¤ºåˆå§‹è¿ç§»çŠ¶æ€ã€‚

æ­¤å‡½æ•°æ‰€ç”¨çš„å¤šå­—èŠ‚å­—ç¬¦ç¼–ç ä¸ºå½“å‰æ´»è·ƒçš„ C æœ¬åœ°ç¯å¢ƒæ‰€æŒ‡å®šã€‚

===å‚æ•°===
{{par begin}}
{{par|pc16|æŒ‡å‘å°†å†™å…¥äº§ç”Ÿçš„ 16-bit å®½å­—ç¬¦çš„ä½ç½®çš„æŒ‡é’ˆ}}
{{par|s|æŒ‡å‘ç”¨ä½œè¾“å…¥çš„å¤šå­—èŠ‚å­—ç¬¦ä¸²çš„æŒ‡é’ˆ}}
{{par|n|èƒ½æ£€éªŒçš„å­—èŠ‚æ•°ä¸Šçš„é™åˆ¶}}
{{par|ps|æŒ‡å‘è½¬è¯‘å¤šå­—èŠ‚å­—ç¬¦ä¸²æ—¶æ‰€ç”¨è½¬æ¢çŠ¶æ€å¯¹è±¡çš„æŒ‡é’ˆ}}
{{par end}}

===è¿”å›å€¼===
ä¸‹åˆ—é¦–ä¸ªèƒ½é€‚ç”¨è€…ï¼š
* è‹¥ä» {{c|s}} è½¬æ¢çš„å­—ç¬¦æ˜¯ç©ºå­—ç¬¦ï¼ˆå¹¶å­˜å‚¨äº {{c|*pc16}}ï¼Œè‹¥å®ƒéç©ºï¼‰ï¼Œåˆ™ä¸º {{c|0}}ã€‚
* æˆåŠŸä» {{c|s}} è½¬æ¢çš„å¤šå­—èŠ‚å­—ç¬¦çš„å­—èŠ‚æ•° {{closed range|1|n}}ã€‚
* è‹¥ä¸‹ä¸ª {{c/core|char16_t}} ç»„æˆå¤š {{c/core|char16_t}} å­—ç¬¦ï¼Œå¹¶å·²å†™å…¥ {{c|*pc16}}ï¼Œåˆ™ä¸º {{c|-3}}ã€‚æ­¤æƒ…å†µä¸‹ä¸ä»è¾“å…¥å¤„ç†å­—èŠ‚ã€‚
* è‹¥æ¥ä¸‹æ¥ {{c|n}} ä¸ªå­—ç¬¦ç»„æˆä¸å®Œæ•´ï¼Œä½†åˆ°æ­¤è¿˜åˆæ³•çš„å¤šå­—èŠ‚å­—ç¬¦ï¼Œåˆ™ä¸º {{c|-2}}ã€‚ä¸å†™å…¥ {{c|*pc16}}ã€‚
* è‹¥å‡ºç°ç¼–ç é”™è¯¯åˆ™ä¸º {{c|-1}}ã€‚ä¸å†™å…¥ {{c|*pc16}}ï¼Œå­˜å‚¨å€¼ {{c|EILSEQ}} äº {{lc|errno}}ï¼Œä¸” {{c|*ps}} çŠ¶æ€æœªæŒ‡å®šã€‚

===ç¤ºä¾‹===
{{example
|code=
#include &lt;clocale&gt;
#include &lt;cstring&gt;
#include &lt;cuchar&gt;
#include &lt;cwchar&gt;
#include &lt;iomanip&gt;
#include &lt;iostream&gt;

int main()
{
    std::setlocale(LC_ALL, "en_US.utf8");

    std::string str{"z\u00df\u6c34\U0001F34C"}; // æˆ– u8"zÃŸæ°´ğŸŒ"

    std::cout &lt;&lt; "å¤„ç† " &lt;&lt; str.size() &lt;&lt; " ä¸ªå­—èŠ‚: [ " &lt;&lt; std::uppercase;
              &lt;&lt; std::setfill('0') &lt;&lt; std::hex;
    for (int n{}; unsigned char c : str)
        std::cout &lt;&lt; (n++ ? " " : "") &lt;&lt; +c;
    std::cout &lt;&lt; "]\n";

    std::mbstate_t state{}; // é›¶åˆå§‹åŒ–åˆ°åˆå§‹çŠ¶æ€
    char16_t c16{};
    const char* ptr{&amp;str[0]}, *end{&amp;str[0] + str.size()};

    while (std::size_t rc{std::mbrtoc16(&amp;c16, ptr, end - ptr + 1, &amp;state)})
    {
        std::cout &lt;&lt; "ä¸‹ä¸€ä¸ª UTF-16 å­—ç¬¦: " &lt;&lt; std::setw(4)
                  &lt;&lt; static_cast&lt;unsigned short&gt;(c16) &lt;&lt; " æ¥è‡ª ";
        if (rc == std::size_t(-3))
            std::cout &lt;&lt; "å‰ä¸€ä¸ªä»£ç†å¯¹\n";
        else if (rc == std::size_t(-2))
            continue;
        else if (rc == (std::size_t) - 1)
            break;
        else
        {
            std::cout &lt;&lt; std::dec &lt;&lt; rc &lt;&lt; " ä¸ªå­—èŠ‚ [";
            for (std::size_t n{}; n != rc; ++n)
                std::cout &lt;&lt; (n ? " " : "") &lt;&lt; std::hex
                          &lt;&lt; +static_cast&lt;unsigned char&gt;(ptr[n]);
            std::cout &lt;&lt; "]\n";
            ptr += rc;
        }
    }
}
|output=
å¤„ç† 10 ä¸ªå­—èŠ‚: [7A C3 9F E6 B0 B4 F0 9F 8D 8C]
ä¸‹ä¸€ä¸ª UTF-16 å­—ç¬¦: 007A æ¥è‡ª 1 ä¸ªå­—èŠ‚ [7A]
ä¸‹ä¸€ä¸ª UTF-16 å­—ç¬¦: 00DF æ¥è‡ª 2 ä¸ªå­—èŠ‚ [C3 9F]
ä¸‹ä¸€ä¸ª UTF-16 å­—ç¬¦: 6C34 æ¥è‡ª 3 ä¸ªå­—èŠ‚ [E6 B0 B4]
ä¸‹ä¸€ä¸ª UTF-16 å­—ç¬¦: D83C æ¥è‡ª 4 ä¸ªå­—èŠ‚ [F0 9F 8D 8C]
ä¸‹ä¸€ä¸ª UTF-16 å­—ç¬¦: DF4C æ¥è‡ªå‰ä¸€ä¸ªä»£ç†å¯¹
}}

===å‚é˜…===
{{dsc begin}}
{{dsc inc|cpp/string/multibyte/dsc c16rtomb}}
{{dsc inc|cpp/string/multibyte/dsc mbrtoc8}}
{{dsc inc|cpp/locale/codecvt/dsc do_in|mem=std::codecvt&lt;char16_t, char, std::mbstate_t&gt;}}
{{dsc see c|c/string/multibyte/mbrtoc16}}
{{dsc end}}

{{langlinks|de|en|es|fr|it|ja|pt|ru}}