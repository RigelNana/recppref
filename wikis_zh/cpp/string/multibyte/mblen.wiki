{{cpp/title|mblen}}
{{cpp/string/multibyte/navbar}}
{{ddcl|header=cstdlib|
int mblen( const char* s, std::size_t n );
}}

ç¡®å®šå¤šå­—èŠ‚å­—ç¬¦çš„å­—èŠ‚å¤§å°ï¼Œå…¶é¦–å­—èŠ‚ä¸º {{c|s}} æ‰€æŒ‡å‘ã€‚

è‹¥ {{c|s}} æ˜¯ç©ºæŒ‡é’ˆï¼Œåˆ™é‡ç½®å…¨å±€è½¬æ¢çŠ¶æ€å¹¶ç¡®å®šæ˜¯å¦ä½¿ç”¨è¿ç§»åºåˆ—ã€‚

æ­¤å‡½æ•°ç­‰ä»·äºè°ƒç”¨ {{c|std::mbtowc((wchar_t*)0, s, n)}}ï¼Œä½†å®ƒä¸å½±å“ {{lc|std::mbtowc}} çš„è½¬æ¢çŠ¶æ€ã€‚

===æ³¨è§£===
æ¯æ¬¡å¯¹ {{tt|mblen}} çš„è°ƒç”¨æ›´æ–°å†…éƒ¨å…¨å±€è½¬æ¢çŠ¶æ€ï¼ˆ{{lc|std::mbstate_t}} ç±»å‹çš„é™æ€å¯¹è±¡ï¼Œåªä¸ºæ­¤å‡½æ•°æ‰€çŸ¥ï¼‰ã€‚è‹¥å¤šå­—èŠ‚ç¼–ç ä½¿ç”¨è¿ç§»çŠ¶æ€ï¼Œåˆ™å¿…é¡»ç•™æ„ä»¥é¿å…å›æ’¤æˆ–å¤šæ¬¡æ‰«æã€‚ä»»ä½•æƒ…å†µä¸‹ï¼Œå¤šçº¿ç¨‹ä¸åº”æ— åŒæ­¥åœ°è°ƒç”¨ {{tt|mblen}}ï¼šå¯ç”¨ {{lc|std::mbrlen}} ä»£æ›¿ã€‚

===å‚æ•°===
{{par begin}}
{{par|s|æŒ‡å‘å¤šå­—èŠ‚å­—ç¬¦çš„æŒ‡é’ˆ}}
{{par|n|{{c|s}} ä¸­èƒ½è¢«æ£€éªŒçš„å­—èŠ‚æ•°é™åˆ¶}}
{{par end}}

===è¿”å›å€¼===
è‹¥ {{c|s}} ä¸æ˜¯ç©ºæŒ‡é’ˆï¼Œåˆ™è¿”å›å¤šå­—èŠ‚å­—ç¬¦æ‰€å«çš„å­—èŠ‚æ•°ï¼Œæˆ–è‹¥ {{c|s}} æ‰€æŒ‡çš„é¦–å­—èŠ‚ä¸ç»„æˆåˆæ³•å¤šå­—èŠ‚å­—ç¬¦åˆ™è¿”å› {{c|-1}}ï¼Œæˆ–è‹¥ {{c|s}} æŒ‡å‘ç©ºå­—ç¬¦ {{c|'\0'}} åˆ™è¿”å› {{c|0}}ã€‚

è‹¥ {{c|s}} æ˜¯ç©ºæŒ‡é’ˆï¼Œåˆ™é‡ç½®å†…éƒ¨è½¬æ¢çŠ¶æ€ä¸ºåˆå§‹è¿ç§»çŠ¶æ€ï¼Œå¹¶è‹¥å½“å‰å¤šå­—èŠ‚ç¼–ç éçŠ¶æ€ä¾èµ–ï¼ˆä¸ä½¿ç”¨è¿ç§»åºåˆ—ï¼‰åˆ™è¿”å› {{c|0}}ï¼Œæˆ–è€…è‹¥å½“å‰å¤šå­—èŠ‚ç¼–ç ä¸ºçŠ¶æ€ä¾èµ–ï¼ˆä½¿ç”¨è¿ç§»åºåˆ—ï¼‰åˆ™è¿”å›éé›¶ã€‚

===ç¤ºä¾‹===
{{example
|code=
#include &lt;clocale&gt;
#include &lt;cstdlib&gt;
#include &lt;iomanip&gt;
#include &lt;iostream&gt;
#include &lt;stdexcept&gt;
#include &lt;string_view&gt;

// å¤šå­—èŠ‚å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦æ•°æ˜¯ mblen() çš„å’Œ
// æ³¨æ„ï¼šæ›´ç®€å•çš„æ‰‹æ®µæ˜¯ std::mbstowcs(NULL, s.c_str(), s.size())
std::size_t strlen_mb(const std::string_view s)
{
    std::mblen(nullptr, 0); // é‡ç½®è½¬æ¢çŠ¶æ€
    std::size_t result = 0;
    const char* ptr = s.data();
    for (const char* const end = ptr + s.size(); ptr &lt; end; ++result)
    {
        const int next = std::mblen(ptr, end - ptr);
        if (next == -1)
            throw std::runtime_error("strlen_mb(): è½¬æ¢é”™è¯¯");
        ptr += next;
    }
    return result;
}

void dump_bytes(const std::string_view str)
{
    std::cout &lt;&lt; std::hex &lt;&lt; std::uppercase &lt;&lt; std::setfill('0');
    for (unsigned char c : str)
        std::cout &lt;&lt; std::setw(2) &lt;&lt; static_cast&lt;int&gt;(c) &lt;&lt; ' ';
    std::cout &lt;&lt; std::dec &lt;&lt; '\n';
}

int main()
{
    // å…è®¸ mblen() ä»¥ UTF-8 å¤šå­—èŠ‚ç¼–ç å·¥ä½œ
    std::setlocale(LC_ALL, "en_US.utf8");
    // UTF-8 çª„å¤šå­—èŠ‚ç¼–ç 
    const std::string_view str = "z\u00df\u6c34\U0001f34c"; // æˆ– u8"zÃŸæ°´ğŸŒ"
    std::cout &lt;&lt; std::quoted(str) &lt;&lt; " æœ‰ " &lt;&lt; strlen_mb(str)
              &lt;&lt; " ä¸ªå­—ç¬¦ï¼Œä½†æœ‰ " &lt;&lt; str.size() &lt;&lt; " ä¸ªå­—èŠ‚: ";
    dump_bytes(str);
}
|p=true
|output=
"zÃŸæ°´ğŸŒ" æœ‰ 4 ä¸ªå­—ç¬¦ï¼Œä½†æœ‰ 10 ä¸ªå­—èŠ‚: 7A C3 9F E6 B0 B4 F0 9F 8D 8C
}}

===å‚é˜…===
{{dsc begin}}
{{dsc inc|cpp/string/multibyte/dsc mbtowc}}
{{dsc inc|cpp/string/multibyte/dsc mbrlen}}
{{dsc see c|c/string/multibyte/mblen}}
{{dsc end}}

{{langlinks|de|en|es|fr|it|ja|pt|ru}}