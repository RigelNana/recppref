{{cpp/title|c16rtomb}}
{{cpp/string/multibyte/navbar}}
{{ddcl|header=cuchar|since=c++11|
std::size_t c16rtomb( char* s, char16_t c16, std::mbstate_t* ps );
}}

ä»å˜é•¿ 16 ä½å®½å­—ç¬¦è¡¨ç¤ºï¼ˆå…¸å‹åœ°ä¸º UTF-16ï¼‰è½¬æ¢å•ä¸ªç¼–ç ç‚¹åˆ°å…¶çª„å¤šå­—èŠ‚å­—ç¬¦è¡¨ç¤ºã€‚

è‹¥ {{c|s}} ä¸æ˜¯ç©ºæŒ‡é’ˆä¸” {{c|c16}} æ˜¯åˆæ³•çš„ç¼–ç ç‚¹å˜é•¿ç¼–ç ä¸­çš„æœ€åä¸€ä¸ª 16 ä½ç¼–ç å•å…ƒï¼Œåˆ™å‡½æ•°ç¡®å®šå­˜å‚¨è¯¥ç¼–ç ç‚¹æ‰€éœ€çš„å­—èŠ‚æ•°ï¼ˆåŒ…å«ä»»ä½•è¿ç§»åºåˆ—ï¼Œå¹¶è€ƒè™‘å½“å‰å¤šå­—èŠ‚è½¬æ¢çŠ¶æ€ {{c|*ps}}ï¼‰ï¼Œå¹¶å­˜å‚¨å¤šå­—èŠ‚è¡¨ç¤ºäºé¦–å…ƒç´ ä¸º {{c|s}} æ‰€æŒ‡å‘çš„å­—ç¬¦æ•°ç»„ï¼Œè‹¥å¿…è¦åˆ™æ›´æ–° {{c|*ps}}ã€‚æ­¤å‡½æ•°æœ€èƒ½å†™å…¥ {{lc|MB_CUR_MAX}} ä¸ªå­—èŠ‚ã€‚

è‹¥ {{c|s}} æ˜¯ç©ºæŒ‡é’ˆï¼Œåˆ™è°ƒç”¨ç­‰ä»·äºå¯¹äºæŸå†…éƒ¨ç¼“å†²åŒº {{tt|buf}} çš„ {{c|std::c16rtomb(buf, u'\0', ps)}} ã€‚

è‹¥ {{c|c16}} æ˜¯ç©ºå®½å­—ç¬¦ {{c|u'\0'}}ï¼Œåˆ™å­˜å‚¨ç©ºå­—èŠ‚ï¼Œå‰é™„æ¢å¤åˆ°åˆå§‹è¿ç§»çŠ¶æ€æ‰€éœ€çš„ä»»ä½•è¿ç§»åºåˆ—ï¼Œå¹¶æ›´æ–° {{c|*ps}} ä»¥è¡¨ç¤ºåˆå§‹è¿ç§»çŠ¶æ€ã€‚

è‹¥ {{c|c16}} ä¸æ˜¯å®½å­—ç¬¦çš„ 16 ä½è¡¨ç¤ºä¸­æœ€ç»ˆç¼–ç å•å…ƒï¼Œåˆ™ä¸å†™å…¥ {{c|s}} æ‰€æŒ‡å‘çš„æ•°ç»„ï¼Œåªæ›´æ–° {{c|*ps}}ã€‚

æ­¤å‡½æ•°æ‰€ç”¨çš„å®½å­—ç¬¦ç¼–ç ä¸ºå½“å‰æ´»è·ƒçš„ C æœ¬åœ°ç¯å¢ƒæ‰€æŒ‡å®šã€‚

===å‚æ•°===
{{par begin}}
{{par|s|æŒ‡å‘å°†å­˜å‚¨å¤šå­—èŠ‚å­—ç¬¦çš„çª„å­—ç¬¦æ•°ç»„çš„æŒ‡é’ˆ}}
{{par|c16|è¦è½¬æ¢çš„ 16 ä½å®½å­—ç¬¦}}
{{par|ps|æŒ‡å‘è½¬è¯‘å¤šå­—èŠ‚å­—ç¬¦ä¸²æ—¶æ‰€ç”¨è½¬æ¢çŠ¶æ€å¯¹è±¡çš„æŒ‡é’ˆ}}
{{par end}}

===è¿”å›å€¼===
æˆåŠŸæ—¶ï¼Œè¿”å›å†™å…¥é¦–å…ƒç´ ä¸º {{c|s}} æ‰€æŒ‡å‘çš„å­—ç¬¦æ•°ç»„çš„å­—èŠ‚æ•°ï¼ˆåŒ…å«ä»»ä½•è¿ç§»åºåˆ—ï¼‰ã€‚æ­¤å€¼å¯ä»¥æ˜¯ {{c|0}}ï¼Œä¾‹å¦‚åœ¨å¤„ç†ä»£ç”¨å¯¹çš„å‰å¯¼ {{c/core|char16_t}} å•å…ƒæ—¶ã€‚

å¤±è´¥æ—¶ï¼ˆè‹¥ {{c|c16}} ä¸æ˜¯åˆæ³•çš„ 16 ä½ç¼–ç å•å…ƒï¼‰ï¼Œåˆ™è¿”å› {{c|-1}}ï¼Œå¹¶å­˜å‚¨ {{lc|EILSEQ}} äº {{lc|errno}}ï¼ŒæŠŠ {{c|*ps}} ç½®äºæœªæŒ‡å®šçŠ¶æ€ã€‚

===æ³¨è§£===
C++ æ ‡å‡†å°†æ­¤å‡½æ•°çš„è¯­ä¹‰å§”æ´¾åˆ° C æ ‡å‡†ã€‚åœ¨ C11 åˆšå‘å¸ƒæ—¶ï¼Œä¸åŒäºè½¬æ¢å˜å®½å¤šå­—èŠ‚ï¼ˆå¦‚ UTF-8ï¼‰åˆ°å˜å®½ 16 ä½ï¼ˆå¦‚ UTF-16ï¼‰ç¼–ç çš„ {{lc|std::mbrtoc16}}ï¼Œæ­¤å‡½æ•°åªèƒ½è½¬æ¢å•ä¸ªå•å…ƒçš„ 16 ä½ç¼–ç ï¼Œè¿™è¡¨ç¤ºå°½ç®¡æ­¤å‡½æ•°çš„åŸç›®çš„å¦‚æ­¤ï¼Œå®ƒä»ä¸èƒ½è½¬æ¢ UTF-16 åˆ° UTF-8ã€‚è¿™ä¸º C11 åçš„ç¼ºé™·æŠ¥å‘Š {{stddoc|n2059.htm#dr_488|DR488|lang=c}} æ‰€æ›´æ­£ã€‚

===ç¤ºä¾‹===
{{example|æ­¤ç¤ºä¾‹å‡è®¾å·²åº”ç”¨{{stddoc|n2059.htm#dr_488|ç¼ºé™·æŠ¥å‘Š 488|lang=c}} çš„ä¿®å¤
|code=
#include &lt;climits&gt;
#include &lt;clocale&gt;
#include &lt;cuchar&gt;
#include &lt;iomanip&gt;
#include &lt;iostream&gt;
#include &lt;string_view&gt;
 
int main()
{
    std::setlocale(LC_ALL, "en_US.utf8");
    std::u16string_view strv = u"zÃŸæ°´ğŸŒ"; // æˆ– z\u00df\u6c34\U0001F34C
    std::cout &lt;&lt; "å¤„ç† " &lt;&lt; strv.size() &lt;&lt; " UTF-16 ä»£ç å•å…ƒ: [ ";
    for (char16_t c : strv)
        std::cout &lt;&lt; std::showbase &lt;&lt; std::hex &lt;&lt; static_cast&lt;int&gt;(c) &lt;&lt; ' ';
    std::cout &lt;&lt; "]\n";
 
    std::mbstate_t state{};
    char out[MB_LEN_MAX]{};
    for (char16_t c : strv)
    {
        std::size_t rc = std::c16rtomb(out, c, &amp;state);
        std::cout &lt;&lt; static_cast&lt;int&gt;(c) &lt;&lt; " è½¬æ¢ä¸º [ ";
        if (rc != (std::size_t) - 1)
            for (unsigned char c8 : std::string_view{out, rc})
                std::cout &lt;&lt; +c8 &lt;&lt; ' ';
        std::cout &lt;&lt; "]\n";
    }
}
|output=
å¤„ç† 5 UTF-16 ä»£ç å•å…ƒ: [ 0x7a 0xdf 0x6c34 0xd83c 0xdf4c ]
0x7a è½¬æ¢ä¸º [ 0x7a ]
0xdf è½¬æ¢ä¸º [ 0xc3 0x9f ]
0x6c34 è½¬æ¢ä¸º [ 0xe6 0xb0 0xb4 ]
0xd83c è½¬æ¢ä¸º [ ]
0xdf4c è½¬æ¢ä¸º [ 0xf0 0x9f 0x8d 0x8c ]
}}

===å‚é˜…===
{{dsc begin}}
{{dsc inc|cpp/string/multibyte/dsc mbrtoc16}}
{{dsc inc|cpp/string/multibyte/dsc c8rtomb}}
{{dsc inc|cpp/locale/codecvt/dsc do_out|mem=std::codecvt&lt;char16_t, char, std::mbstate_t&gt;}}
{{dsc see c|c/string/multibyte/c16rtomb}}
{{dsc end}}

{{langlinks|de|en|es|fr|it|ja|pt|ru}}