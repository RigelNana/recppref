{{cpp/utility/any/title|type}}
{{cpp/utility/any/navbar}}
{{ddcl|since=c++17|
const std::type_info&amp; type() const noexcept;
}}

查询所含类型。

===返回值===
若实例非空则为所含值的 {{lc|typeid}}，否则为 {{c|typeid(void)}}。

===示例===
{{example
|示例演示有能力在编译和运行时注册新访问者的 {{tt|std::any}} 访问者手法。
|code=
#include &lt;any&gt;
#include &lt;functional&gt;
#include &lt;iomanip&gt;
#include &lt;iostream&gt;
#include &lt;type_traits&gt;
#include &lt;typeindex&gt;
#include &lt;typeinfo&gt;
#include &lt;unordered_map&gt;
#include &lt;vector&gt;
 
template&lt;class T, class F&gt;
inline std::pair&lt;const std::type_index, std::function&lt;void(const std::any&amp;)&gt;&gt;
    to_any_visitor(const F&amp; f)
{
    return
    {
        std::type_index(typeid(T)),
        [g = f](std::any const&amp; a)
        {
            if constexpr (std::is_void_v&lt;T&gt;)
                g();
            else
                g(std::any_cast&lt;T const&amp;&gt;(a));
        }
    };
}

static std::unordered_map&lt;std::type_index, std::function&lt;void(const std::any&amp;)&gt;&gt;
    any_visitor
{
    to_any_visitor&lt;void&gt;([] { std::cout &lt;&lt; "{}"; }),
    to_any_visitor&lt;int&gt;([](int x) { std::cout &lt;&lt; x; }),
    to_any_visitor&lt;unsigned&gt;([](unsigned x) { std::cout &lt;&lt; x; }),
    to_any_visitor&lt;float&gt;([](float x) { std::cout &lt;&lt; x; }),
    to_any_visitor&lt;double&gt;([](double x) { std::cout &lt;&lt; x; }),
    to_any_visitor&lt;char const*&gt;([](char const* s)
        { std::cout &lt;&lt; std::quoted(s); }),
    // ……为你的类型添加更多的处理器……
};

inline void process(const std::any&amp; a)
{
    if (const auto it = any_visitor.find(std::type_index(a.type()));
        it != any_visitor.cend())
        it-&gt;second(a);
    else
        std::cout &lt;&lt; "未注册类型 " &lt;&lt; std::quoted(a.type().name());
}

template&lt;class T, class F&gt;
inline void register_any_visitor(const F&amp; f)
{
    std::cout &lt;&lt; "为类型 "
              &lt;&lt; std::quoted(typeid(T).name()) &lt;&lt; " 注册访问者\n";
    any_visitor.insert(to_any_visitor&lt;T&gt;(f));
}
 
int main()
{
    std::vector&lt;std::any&gt; va{&lt;!----&gt;{}, 42, 123u, 3.14159f, 2.71828, "C++17"};
 
    for (int n{}; const std::any&amp; a : va)
    {
        std::cout &lt;&lt; (n++ ? ", " : "[");
        process(a);
    }
    std::cout &lt;&lt; "]\n";

    process(std::any(0xFULL)); //&lt; 反注册类型 "y"（unsigned long long）
    std::cout &lt;&lt; '\n';

    register_any_visitor&lt;unsigned long long&gt;([](auto x)
    {
        std::cout &lt;&lt; std::hex &lt;&lt; std::showbase &lt;&lt; x; 
    });

    process(std::any(0xFULL)); //&lt; OK: 0xf
    std::cout &lt;&lt; '\n';
}
|p=true&lt;!--type_info::name() is implementation defined--&gt;
|output=
[{}, 42, 123, 3.14159, 2.71828, "C++17"]
未注册类型 "y"
为类型 "y" 注册访问者
0xf
}}

===参阅===
{{dsc begin}}
{{dsc inc|cpp/types/dsc type_index}}
{{dsc end}}

{{langlinks|en|es|ja|ru}}