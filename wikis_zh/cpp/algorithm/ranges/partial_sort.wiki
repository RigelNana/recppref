{{cpp/ranges/title|partial_sort}}
{{cpp/algorithm/ranges/navbar}}
{{dcl begin}}
{{dcl header|algorithm}}
{{dcl h|è°ƒç”¨ç­¾å}}
{{dcl|since=c++20|num=1|1=
template&lt; std::random_access_iterator I, std::sentinel_for&lt;I&gt; S,
          class Comp = ranges::less, class Proj = std::identity &gt;
requires std::sortable&lt;I, Comp, Proj&gt;
constexpr I
    partial_sort( I first, I middle, S last, Comp comp = {}, Proj proj = {} );
}}
{{dcl|since=c++20|num=2|1=
template&lt; ranges::random_access_range R,
          class Comp = ranges::less, class Proj = std::identity &gt;
requires std::sortable&lt;ranges::iterator_t&lt;R&gt;, Comp, Proj&gt;
constexpr ranges::borrowed_iterator_t&lt;R&gt;
    partial_sort( R&amp;&amp; r, ranges::iterator_t&lt;R&gt; middle, Comp comp = {},
                  Proj proj = {} );
}}
{{dcl end}}

@1@ é‡æ’å…ƒç´ ï¼Œä½¿å¾—èŒƒå›´ {{range|first|middle}} å«æœ‰èŒƒå›´ {{range|first|last}} ä¸­ {{c|middle - first}} ä¸ªæœ€å°çš„å…ƒç´ ã€‚

@@ ''ä¸''ä¿è¯ä¿æŒç›¸ç­‰å…ƒç´ é—´çš„é¡ºåºã€‚èŒƒå›´ {{range|middle|last}} ä¸­å‰©ä½™å…ƒç´ çš„é¡ºåº''æœªæŒ‡å®š''ã€‚

@@ ç”¨ç»™å®šçš„äºŒå…ƒæ¯”è¾ƒå‡½æ•° {{c|comp}} æ¯”è¾ƒï¼Œç”¨ {{c|proj}} å‡½æ•°å¯¹è±¡æŠ•å½±å…ƒç´ ã€‚

@2@ åŒ {{v|1}}ï¼Œä½†ä»¥ {{c|r}} ä¸ºèŒƒå›´ï¼Œå¦‚åŒä»¥ {{c|ranges::begin(r)}} ä¸º {{c|first}} å¹¶ä»¥ {{c|ranges::end(r)}} ä¸º {{c|last}}ã€‚

{{cpp/ranges/niebloid}}

===å‚æ•°===
{{par begin}}
{{par range|3=è¦é‡æ’çš„|sentinel=yes}}
{{par|r|è¦é‡æ’çš„å…ƒç´ èŒƒå›´}}
{{par|middle|å°†å¯¹èŒƒå›´ {{range|first|middle}} æ’åº}}
{{par|comp|åº”ç”¨åˆ°æŠ•å½±åå…ƒç´ çš„æ¯”è¾ƒå™¨}}
{{par|proj|åº”ç”¨åˆ°å…ƒç´ çš„æŠ•å½±}}
{{par end}}

===è¿”å›å€¼===
ç­‰äº {{c|last}} çš„è¿­ä»£å™¨ã€‚

===å¤æ‚åº¦===
{{mathjax-or|\(\scriptsize \mathcal{O}(N\cdot\log{(M)})\)|ğ“(N&amp;middot;log(M))}} æ¬¡æ¯”è¾ƒå’ŒäºŒå€æ¬¡æ•°çš„æŠ•å½±ï¼Œå…¶ä¸­ {{mathjax-or|\(\scriptsize N\)|N}} ä¸º {{c|ranges::distance(first, last)}}ï¼Œ{{mathjax-or|\(\scriptsize M\)|M}} ä¸º {{c|ranges::distance(first, middle)}}ã€‚

===å¯èƒ½çš„å®ç°===
{{eq fun|1=
struct partial_sort_fn
{
    template&lt;std::random_access_iterator I, std::sentinel_for&lt;I&gt; S,
             class Comp = ranges::less, class Proj = std::identity&gt;
    requires std::sortable&lt;I, Comp, Proj&gt;
    constexpr I
        operator()(I first, I middle, S last, Comp comp = {}, Proj proj = {}) const
    {
        if (first == middle)
            return ranges::next(first, last);
        ranges::make_heap(first, middle, comp, proj);
        auto it {middle};
        for (; it != last; ++it)
        {
            if (std::invoke(comp, std::invoke(proj, *it), std::invoke(proj, *first)))
            {
                ranges::pop_heap(first, middle, comp, proj);
                ranges::iter_swap(middle - 1, it);
                ranges::push_heap(first, middle, comp, proj);
            }
        }
        ranges::sort_heap(first, middle, comp, proj);
        return it;
    }

    template&lt;ranges::random_access_range R, class Comp = ranges::less,
             class Proj = std::identity&gt;
    requires std::sortable&lt;ranges::iterator_t&lt;R&gt;, Comp, Proj&gt;
    constexpr ranges::borrowed_iterator_t&lt;R&gt;
        operator()(R&amp;&amp; r, ranges::iterator_t&lt;R&gt; middle, Comp comp = {}, Proj proj = {}) const
    {
        return (*this)(ranges::begin(r), std::move(middle), ranges::end(r),
                       std::move(comp), std::move(proj));
    }
};

inline constexpr partial_sort_fn partial_sort {};
}}

===ç¤ºä¾‹===
{{example|code=
#include &lt;algorithm&gt;
#include &lt;functional&gt;
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;vector&gt;

void print(const auto&amp; v)
{
    for (const char e : v)
        std::cout &lt;&lt; e &lt;&lt; ' ';
    std::cout &lt;&lt; '\n';
}

void underscore(int n)
{
    while (n-- &gt; 0)
        std::cout &lt;&lt; "^ ";
    std::cout &lt;&lt; '\n';
}

int main()
{
    static_assert('A' &lt; 'a');
    std::vector&lt;char&gt; v {'x', 'P', 'y', 'C', 'z', 'w', 'P', 'o'};
    print(v);
    const int m {3};
    std::ranges::partial_sort(v, v.begin() + m);
    print(v), underscore(m);

    static_assert('1' &lt; 'a');
    std::string s {"3a1b41c5"};
    print(s);
    std::ranges::partial_sort(s.begin(), s.begin() + m, s.end(), std::greater {});
    print(s), underscore(m);
}
|output=
x P y C z w P o
C P P y z x w o
^ ^ ^
3 a 1 b 4 1 c 5
c b a 1 3 1 4 5
^ ^ ^
}}

===å‚é˜…===
{{dsc begin}}
{{dsc inc|cpp/algorithm/ranges/dsc partial_sort_copy}}
{{dsc inc|cpp/algorithm/ranges/dsc sort}}
{{dsc inc|cpp/algorithm/ranges/dsc stable_sort}}
{{dsc inc|cpp/algorithm/ranges/dsc nth_element}}
{{dsc inc|cpp/algorithm/ranges/dsc make_heap}}
{{dsc inc|cpp/algorithm/ranges/dsc pop_heap}}
{{dsc inc|cpp/algorithm/ranges/dsc push_heap}}
{{dsc inc|cpp/algorithm/ranges/dsc sort_heap}}
{{dsc inc|cpp/algorithm/dsc partial_sort}}
{{dsc end}}

{{langlinks|de|en|es|fr|it|ja|pt|ru}}