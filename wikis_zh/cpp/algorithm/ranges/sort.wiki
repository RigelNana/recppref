{{cpp/ranges/title|sort}}
{{cpp/algorithm/ranges/navbar}}
{{dcl begin}}
{{dcl header|algorithm}}
{{dcl h|è°ƒç”¨ç­¾å}}
{{dcl|since=c++20|num=1|1=
template&lt; std::random_access_iterator I, std::sentinel_for&lt;I&gt; S,
          class Comp = ranges::less, class Proj = std::identity &gt;
requires std::sortable&lt;I, Comp, Proj&gt;
constexpr I 
    sort( I first, S last, Comp comp = {}, Proj proj = {} );
}}
{{dcl|since=c++20|num=2|1=
template&lt; ranges::random_access_range R, class Comp = ranges::less,
          class Proj = std::identity &gt;
requires std::sortable&lt;ranges::iterator_t&lt;R&gt;, Comp, Proj&gt;
constexpr ranges::borrowed_iterator_t&lt;R&gt;
    sort( R&amp;&amp; r, Comp comp = {}, Proj proj = {} );
}}
{{dcl end}}

ä»¥éé™åºæ’åºèŒƒå›´ {{range|first|last}} ä¸­çš„å…ƒç´ ã€‚ä¸ä¿è¯ä¿æŒç­‰ä»·å…ƒç´ çš„é¡ºåºã€‚

è‹¥å¯¹äºæŒ‡å‘åºåˆ—çš„ä»»ä½•è¿­ä»£å™¨ {{tt|it}} ä¸ä½¿å¾— {{tt|it + n}} ä¸ºæŒ‡å‘åºåˆ—å…ƒç´ çš„åˆæ³•è¿­ä»£å™¨çš„ä»»ä½•éè´Ÿæ•´æ•° {{tt|n}}ï¼Œ{{c|std::invoke(comp, std::invoke(proj, *(it + n)), std::invoke(proj, *it))}} æ±‚å€¼å‡ä¸º {{c|false}}ï¼Œåˆ™ç§°åºåˆ—ç›¸å¯¹äºæ¯”è¾ƒå™¨ {{c|comp}} æœ‰åºã€‚

@1@ ç”¨ç»™å®šçš„äºŒå…ƒæ¯”è¾ƒå‡½æ•° {{c|comp}} æ¯”è¾ƒå…ƒç´ ã€‚
@2@ åŒ {{v|1}}ï¼Œä½†ä»¥ {{c|r}} ä¸ºæºèŒƒå›´ï¼Œå¦‚åŒä»¥ {{c|ranges::begin(r)}} ä¸º {{c|first}} å¹¶ä»¥ {{c|ranges::end(r)}} ä¸º {{c|last}}ã€‚

{{cpp/ranges/niebloid}}

===å‚æ•°===
{{par begin}}
{{par range|3=è¦æ’åºçš„|sentinel=yes}}
{{par|r|è¦æ’åºçš„èŒƒå›´}}
{{par|comp|åº”ç”¨åˆ°æŠ•å½±åå…ƒç´ çš„è°“è¯}}
{{par|proj|åº”ç”¨åˆ°å…ƒç´ çš„æŠ•å½±}}
{{par end}}

===è¿”å›å€¼===
ç­‰äº {{tt|last}} çš„è¿­ä»£å™¨ã€‚

===å¤æ‚åº¦===
åº”ç”¨æ¯”è¾ƒä¸æŠ•å½± {{mathjax-or|\(\scriptsize \mathcal{O}(N\cdot\log{(N)})\)|ğ“(N&amp;middot;log(N))}} æ¬¡ï¼Œå…¶ä¸­ {{c|1=N = ranges::distance(first, last)}}ã€‚

===å¯èƒ½çš„å®ç°===
æ³¨æ„å…¸å‹å®ç°ä½¿ç”¨{{enwiki|Introsort|å†…çœæ’åº}}ã€‚å‚é˜… [https://github.com/microsoft/STL/blob/e745bad3b1d05b5b19ec652d68abb37865ffa454/stl/inc/algorithm#L7575-L7641 MSVC STL] ä¸ [https://github.com/gcc-mirror/gcc/blob/54258e22b0846aaa6bd3265f592feb161eecda75/libstdc%2B%2B-v3/include/bits/ranges_algo.h#L1808-L1834 libstdc++] ä¸­çš„å®ç°ã€‚
{{eq fun|1=
struct sort_fn
{
    template&lt;std::random_access_iterator I, std::sentinel_for&lt;I&gt; S,
             class Comp = ranges::less, class Proj = std::identity&gt;
    requires std::sortable&lt;I, Comp, Proj&gt;
    constexpr I
        operator()(I first, S last, Comp comp = {}, Proj proj = {}) const
    {
        if (first == last)
            return first;
&lt;!--    
        const auto pivot = *ranges::next(first, ranges::distance(first, last) / 2, last);
        
        auto tail1 = ranges::partition(first, last, [&amp;pivot, &amp;comp, &amp;proj](const auto&amp; em) {
            return std::invoke(comp, std::invoke(proj, em), std::invoke(proj, pivot)); });
        auto tail2 = ranges::partition(tail1, [&amp;pivot, &amp;comp, &amp;proj](const auto&amp; em) { 
            return !std::invoke(comp, std::invoke(proj, pivot), std::invoke(proj, em)); });
        
        (*this)(first, tail1.begin(), std::ref(comp), std::ref(proj));
        (*this)(tail2, std::ref(comp), std::ref(proj));
        
        return {ranges::next(first, last)};
--&gt;

        I last_iter = ranges::next(first, last);
        ranges::make_heap(first, last_iter, std::ref(comp), std::ref(proj));
        ranges::sort_heap(first, last_iter, std::ref(comp), std::ref(proj));
        
        return last_iter;
    }
    
    template&lt;ranges::random_access_range R, class Comp = ranges::less,
             class Proj = std::identity&gt;
    requires std::sortable&lt;ranges::iterator_t&lt;R&gt;, Comp, Proj&gt;
    constexpr ranges::borrowed_iterator_t&lt;R&gt;
        operator()(R&amp;&amp; r, Comp comp = {}, Proj proj = {}) const
    {
        return (*this)(ranges::begin(r), ranges::end(r), std::move(comp), std::move(proj));
    }
};

inline constexpr sort_fn sort {};
}}

===æ³¨è§£===
{{lc|std::sort}} ä½¿ç”¨ {{lc|std::iter_swap}} æ¥äº¤æ¢å…ƒç´ ï¼Œè€Œ {{tt|ranges::sort}} ä»£ä¹‹ä»¥ä½¿ç”¨ {{lc|ranges::iter_swap}}ï¼ˆå®ƒä¼šå¯¹ {{tt|iter_swap}} è¿›è¡Œ ADLï¼Œè¿™ä¸ {{lc|std::iter_swap}} ä¸åŒï¼‰

===ç¤ºä¾‹===
{{example
|code=
#include &lt;algorithm&gt;
#include &lt;array&gt;
#include &lt;functional&gt;
#include &lt;iomanip&gt;
#include &lt;iostream&gt;

void print(auto comment, auto const&amp; seq, char term = ' ')
{
    for (std::cout &lt;&lt; comment &lt;&lt; '\n'; auto const&amp; elem : seq)
        std::cout &lt;&lt; elem &lt;&lt; term;
    std::cout &lt;&lt; '\n';
}

struct Particle
{
    std::string name; double mass; // MeV
    template&lt;class Os&gt; friend
    Os&amp; operator&lt;&lt;(Os&amp; os, Particle const&amp; p)
    {
        return os &lt;&lt; std::left &lt;&lt; std::setw(8) &lt;&lt; p.name &lt;&lt; " : " &lt;&lt; p.mass &lt;&lt; ' ';
    }
};

int main()
{
    std::array s {5, 7, 4, 2, 8, 6, 1, 9, 0, 3};

    namespace ranges = std::ranges;

    ranges::sort(s);
    print("ä»¥é»˜è®¤ operator&lt; æ’åº", s);

    ranges::sort(s, ranges::greater());
    print("ä»¥æ ‡å‡†åº“æ¯”è¾ƒå‡½æ•°å¯¹è±¡æ’åº", s);

    struct
    {
        bool operator()(int a, int b) const { return a &lt; b; }
    } customLess;
    ranges::sort(s.begin(), s.end(), customLess);
    print("ä»¥è‡ªå®šä¹‰å‡½æ•°å¯¹è±¡æ’åº", s);

    ranges::sort(s, [](int a, int b) { return a &gt; b; });
    print("ä»¥ lambda è¡¨è¾¾å¼æ’åº", s);

    Particle particles[]
    {
        {"Electron", 0.511}, {"Muon", 105.66}, {"Tau", 1776.86},
        {"Positron", 0.511}, {"Proton", 938.27}, {"Neutron", 939.57}
    };
    ranges::sort(particles, {}, &amp;Particle::name);
    print("ä»¥æŠ•å½±æŒ‰åå­—æ’åº", particles, '\n');
    ranges::sort(particles, {}, &amp;Particle::mass);
    print("ä»¥æŠ•å½±æŒ‰è´¨é‡æ’åº", particles, '\n');
}
|output=
ä»¥é»˜è®¤ operator&lt; æ’åº
0 1 2 3 4 5 6 7 8 9
ä»¥æ ‡å‡†åº“æ¯”è¾ƒå‡½æ•°å¯¹è±¡æ’åº
9 8 7 6 5 4 3 2 1 0
ä»¥è‡ªå®šä¹‰å‡½æ•°å¯¹è±¡æ’åº
0 1 2 3 4 5 6 7 8 9
ä»¥ lambda è¡¨è¾¾å¼æ’åº
9 8 7 6 5 4 3 2 1 0

ä»¥æŠ•å½±æŒ‰åå­—æ’åº
Electron : 0.511
Muon     : 105.66
Neutron  : 939.57
Positron : 0.511
Proton   : 938.27
Tau      : 1776.86

ä»¥æŠ•å½±æŒ‰è´¨é‡æ’åº
Electron : 0.511
Positron : 0.511
Muon     : 105.66
Proton   : 938.27
Neutron  : 939.57
Tau      : 1776.86
}}

===å‚é˜…===
{{dsc begin}}
{{dsc inc|cpp/algorithm/ranges/dsc partial_sort}}
{{dsc inc|cpp/algorithm/ranges/dsc stable_sort}}
{{dsc inc|cpp/algorithm/ranges/dsc partition}}
{{dsc inc|cpp/algorithm/dsc sort}}
{{dsc end}}

{{langlinks|en|es|ja|ru}}