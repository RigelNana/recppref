{{title|浮点数环境 {{mark since c++11}}}}
{{cpp/numeric/fenv/navbar}}

浮点数环境是实现所支持的浮点数状态标志及控制模式的集合。它是线程局部的，每个线程从父线程继承其浮点数环境的初始状态。浮点数运算修改浮点数状态标志，以指示异常结果或辅助信息。浮点数控制模式的状态对一些浮点数运算的产出有影响。

浮点数环境访问和修改仅在 {{ltt|cpp/preprocessor/impl|#pragma STDC FENV_ACCESS}} 得到支持并被设为 {{tt|ON}} 时有意义。否则实现有假设浮点数控制模式始终是默认，且浮点数状态标志决不被测试或被修改的自由。实践中，少数当前编译器，例如 HP aCC、Oracle Studio 或 IBM XL 显式支持 {{tt|#pragma}}，但无论如何，大多数编译器允许有意义地访问浮点数环境。

===类型===
{{dsc begin}}
{{dsc header|cfenv}}
{{dsc inc|cpp/numeric/fenv/dsc fenv_t}}
{{dsc inc|cpp/numeric/fenv/dsc fexcept_t}}
{{dsc end}}

===函数===
{{dsc begin}}
{{dsc inc|cpp/numeric/fenv/dsc feclearexcept}}
{{dsc inc|cpp/numeric/fenv/dsc fetestexcept}}
{{dsc inc|cpp/numeric/fenv/dsc feraiseexcept}}
{{dsc inc|cpp/numeric/fenv/dsc feexceptflag}}
{{dsc inc|cpp/numeric/fenv/dsc feround}}
{{dsc inc|cpp/numeric/fenv/dsc feenv}}
{{dsc inc|cpp/numeric/fenv/dsc feholdexcept}}
{{dsc inc|cpp/numeric/fenv/dsc feupdateenv}}
{{dsc end}}

===宏===
{{dsc begin}}
{{dsc inc|cpp/numeric/fenv/dsc FE_exceptions}}
{{dsc inc|cpp/numeric/fenv/dsc FE_round}}
{{dsc inc|cpp/numeric/fenv/dsc FE_DFL_ENV}}
{{dsc end}}

===注解===
浮点数异常与 C++ 异常无关。浮点数运算引发浮点数异常时，浮点数环境的状态改变，这能用 {{lc|std::fetestexcept}} 测试，但绝大多数实现上 C++ 程序会不中断地持续执行。

有一些编译器扩展，可用于凡在引发浮点数异常时自动生成 C++ 异常：

* GNU libc 函数 [https://www.gnu.org/savannah-checkouts/gnu/libc/manual/html_node/Control-Functions.html {{tt|feenableexcept()}}] 启用浮点数异常的陷阱，它生成信号 {{tt|SIGFPE}}。若使用编译器选项 {{tt|-fnon-call-exceptions}}，则该信号的处理函数可抛出用户定义的 C++ 异常。
* MSVC 函数 [https://learn.microsoft.com/en-us/cpp/c-runtime-library/reference/control87-controlfp-control87-2 {{tt|_control87()}}] 启用浮点数异常的陷阱，它生成硬件异常，这能用 [https://learn.microsoft.com/en-us/cpp/c-runtime-library/reference/set-se-translator {{tt|_set_se_translator}}] 转换成 C++ 异常。

===参阅===
{{dsc begin}}
{{dsc see c|c/numeric/fenv|浮点数环境}}
{{dsc end}}

{{langlinks|de|en|es|fr|it|ja|pt|ru}}