{{cpp/title|sph_legendre|sph_legendref|sph_legendrel}}
{{cpp/numeric/special_functions/navbar}}
{{dcl begin}}
{{dcl header|cmath}}
{{dcl rev multi|num=1|since1=c++17|dcl1=
float       sph_legendre ( unsigned l, unsigned m, float theta );
double      sph_legendre ( unsigned l, unsigned m, double theta );
long double sph_legendre ( unsigned l, unsigned m, long double theta );
|since2=c++23|dcl2=
/* 浮点数类型 */ sph_legendre( unsigned l, unsigned m,
                                        /* 浮点数类型 */ theta );
}}
{{dcl|num=2|since=c++17|
float       sph_legendref( unsigned l, unsigned m, float theta );
}}
{{dcl|num=3|since=c++17|
long double sph_legendrel( unsigned l, unsigned m, long double theta );
}}
{{dcl h|[[#注解|额外重载]]}}
{{dcl header|cmath}}
{{dcl|num=A|since=c++17|
template&lt; class Integer &gt;
double      sph_legendre ( unsigned l, unsigned m, Integer theta );
}}
{{dcl end}}

@1-3@ 计算 {{c|l}} 次、{{c|m}} 阶和极角 {{c|theta}} 的{{enwiki|Spherical harmonics#Orthogonality and normalization|球关联勒让德函数}}。{{rev inl|since=c++23|标准库提供所有以无 cv 限定的浮点数类型作为形参 {{c|theta}} 的类型的 {{tt|std::sph_legendre}} 重载。}}
@A@ 为所有整数类型提供额外重载，将它们当做 {{c/core|double}}。

===参数===
{{par begin}}
{{par|l|次数}}
{{par|m|阶数}}
{{par|theta|极角，以弧度度量}}
{{par end}}

===返回值===
如果没有发生错误，那么返回 {{c|l}}、{{c|m}} 和 {{c|theta}} 的球关联勒让德函数（即 ϕ = 0 下的球谐函数）的值，其中球谐函数定义为 {{math|1=Y{{su|b=l|p=m}}(theta,ϕ) = (-1){{su|p=m}}[{{mfrac|(2l+1)(l-m)!|4π(l+m)!}}]{{su|p=1/2}}P{{su|b=l|p=m}}(cos(theta))e{{su|p=imϕ}}}}，其中 {{math|P{{su|b=l|p=m}}(x)}} 是 {{c|std::assoc_legendre(l, m, x)}}) 且 {{math|{{!}}m{{!}}≤l}}。

注意此函数定义包含 [https://mathworld.wolfram.com/Condon-ShortleyPhase.html Condon-Shortley 相位项] {{math|(-1){{su|p=m}}}}，因为以 {{lc|std::assoc_legendre}} 定义的 {{math|P{{su|b=l|p=m}}}} 忽略了它。

===错误处理===
可能报告 {{lc|math_errhandling}} 中指定的错误。
* 如果实参是 NaN，那么返回 NaN 且不报告定义域错误
* 如果 {{math|l≥128}}，那么行为由实现定义

===注解===
{{cpp/numeric/special functions/older impl note}}

球谐函数的一种实现参考 [https://www.boost.org/doc/libs/release/libs/math/doc/html/math_toolkit/sf_poly/sph_harm.html boost.math]，且它在以设为零的参数 {{tt|phi}} 调用时规约到此函数。

{{cpp/numeric/special functions/additional integer overload note|sph_legendre}}

===示例===
{{example
|code=
#include &lt;cmath&gt;
#include &lt;iostream&gt;
#include &lt;numbers&gt;

int main()
{
    // 对于 l=3, m=0 的点检查
    double x = 1.2345;
    std::cout &lt;&lt; "Y_3^0(" &lt;&lt; x &lt;&lt; ") = " &lt;&lt; std::sph_legendre(3, 0, x) &lt;&lt; '\n';

    // 准确解
    std::cout &lt;&lt; "准确解 = "
              &lt;&lt; 0.25 * std::sqrt(7 / std::numbers::pi)
                  * (5 * std::pow(std::cos(x), 3) - 3 * std::cos(x))
              &lt;&lt; '\n';
}
|output=
Y_3^0(1.2345) = -0.302387
准确解 = -0.302387
}}

===参阅===
{{dsc begin}}
{{dsc inc|cpp/numeric/special functions/dsc assoc_legendre}}
{{dsc end}}

===外部链接===
{{eli|[https://mathworld.wolfram.com/SphericalHarmonic.html Weisstein, Eric W. “球谐”]来自 MathWorld--A Wolfram Web Resource。}}

{{langlinks|en|es|ja}}