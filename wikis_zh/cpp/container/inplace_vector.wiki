{{cpp/title|inplace_vector}}
{{cpp/container/inplace_vector/navbar}}
{{ddcl|header=inplace_vector|since=c++26|
template&lt;
    class T,
    std::size_t N
&gt; struct inplace_vector;
}}

{{tt|inplace_vector}} æ˜¯å…·æœ‰è¿ç»­åŸä½å­˜å‚¨çš„å¯åŠ¨æ€è°ƒæ•´å¤§å°çš„æ•°ç»„ã€‚åœ¨å¯¹è±¡è‡ªèº«å†…éƒ¨å­˜å‚¨ {{tt|T}} ç±»å‹çš„å…ƒç´ å¹¶ä¸”é€‚å½“å¯¹é½ã€‚å†…éƒ¨å­˜å‚¨çš„å®¹é‡æ˜¯åœ¨ç¼–è¯‘æ—¶å›ºå®šçš„ï¼Œç­‰äº {{c|N}}ã€‚

å„å…ƒç´ è¿ç»­å­˜å‚¨ï¼Œè¿™è¡¨ç¤ºä¸ä»…å¯ä»¥é€šè¿‡è¿­ä»£å™¨æˆ–è€…éšæœºè®¿é—®çš„ {{c/core|operator[]}} æ¥è®¿é—®å…ƒç´ ï¼Œä¹Ÿå¯ä»¥åœ¨æŒ‡å‘å…ƒç´ çš„å¸¸è§„æŒ‡é’ˆä¸Šä½¿ç”¨åç§»é‡ã€‚å¯ä»¥å°†æŒ‡å‘ {{tt|inplace_vector}} å…ƒç´ çš„æŒ‡é’ˆä¼ é€’ç»™ä»»ä½•æ¥å—æŒ‡å‘ C æ•°ç»„å…ƒç´ æŒ‡é’ˆçš„å‡½æ•°ã€‚

{{tt|inplace_vector}} å®ç°{{named req|Container}}ã€{{named req|ReversibleContainer}}ã€{{named req|ContiguousContainer}} å’Œ{{named req|SequenceContainer}}ï¼ŒåŒ…æ‹¬å¤§å¤šæ•°[[cpp/named_req/SequenceContainer#å¯é€‰æ“ä½œ|å¯é€‰åºåˆ—å®¹å™¨æ“ä½œ]]ï¼Œä½†ä¸æä¾›æˆå‘˜å‡½æ•° {{tt|push_front}}ã€{{tt|emplace_front}}ã€{{tt|pop_front}} å’Œ {{tt|prepend_range}}ã€‚

å¯¹äºä»»æ„æ­£æ•° {{c|N}}ï¼Œ{{c/core|std::inplace_vector&lt;T, N&gt;::iterator}} å’Œ {{c/core|std::inplace_vector&lt;T, N&gt;::const_iterator}} æ»¡è¶³{{named req|ConstexprIterator}}çš„è¦æ±‚ã€‚

ç‰¹åŒ– {{c/core|std::inplace_vector&lt;T, 0&gt;}} {{named req|TriviallyCopyable}}ï¼Œå¹¶ä¸”ä¸ºç©ºã€‚åŒæ—¶ {{c|std::is_trivially_default_constructible_v&lt;std::inplace_vector&lt;T, 0&gt;&gt;}} æ˜¯ {{c|true}}ã€‚

{{c/core|std::inplace_vector&lt;T, N&gt;}} çš„ä»»ä½•å¯¼è‡´è¶…å‡ºå®¹é‡ {{c|N}} çš„æ’å…¥å‡½æ•°éƒ½ä¼šæŠ›å‡º {{lc|std::bad_alloc}}ã€‚

{{tt|inplace_vector}} ä¸Šä¸€èˆ¬æ“ä½œçš„å¤æ‚åº¦å¦‚ä¸‹ï¼š
* é€šè¿‡ {{rlt|operator at|operator[]}} æˆ– {{rlt|at|at()}} éšæœºè®¿é—®å…ƒç´ â€”â€”å¸¸æ•°ï¼š{{math|ğ“(1)}}ã€‚
* åœ¨æœ«å°¾æ’å…¥æˆ–ç§»é™¤ä¸€ä¸ªå…ƒç´ â€”â€”å¸¸æ•°ï¼š{{math|ğ“(1)}}ã€‚
* åœ¨æœ«å°¾æ’å…¥æˆ–ç§»é™¤å¤šä¸ªå…ƒç´ â€”â€”ä¸æ’å…¥æˆ–ç§»é™¤çš„å…ƒç´ æ•°é‡æˆçº¿æ€§ï¼š{{math|ğ“(n)}}ã€‚
* åœ¨å¼€å¤´æˆ–ä¸­é—´æ’å…¥æˆ–ç§»é™¤å¤šä¸ªå…ƒç´ â€”â€”ä¸æ’å…¥æˆ–ç§»é™¤çš„å…ƒç´ æ•°é‡åŠ ä¸Šåˆ°å‘é‡æœ«å°¾çš„è·ç¦»æˆçº¿æ€§ï¼š{{math|ğ“(n)}}ã€‚

===è¿­ä»£å™¨å¤±æ•ˆ===
{{tt|std::inplace_vector}} è¿­ä»£å™¨çš„å¤±æ•ˆä¿è¯ä¸ {{lc|std::vector}} çš„ä¸åŒï¼š
* ç§»åŠ¨ {{tt|inplace_vector}} ä¼šä½¿æ‰€æœ‰è¿­ä»£å™¨å¤±æ•ˆï¼›
* äº¤æ¢ä¸¤ä¸ª {{tt|inplace_vector}} ä¼šä½¿æ‰€æœ‰è¿­ä»£å™¨å¤±æ•ˆï¼ˆäº¤æ¢è¿‡ç¨‹ä¸­ï¼Œè¿­ä»£å™¨ä¼šç»§ç»­æŒ‡å‘ç›¸åŒçš„æ•°ç»„å…ƒç´ ï¼Œå¹¶å¯èƒ½æ”¹å˜å…¶å€¼ï¼‰ã€‚
è¿™äº›æˆå‘˜å‡½æ•°æ½œåœ¨åœ°ä¼šä½¿è¿­ä»£å™¨å¤±æ•ˆï¼š
{{rlt|operator{{=}}}}ã€{{rlt|assign}}ã€{{rlt|assign_range}}ã€{{rlt|clear}}ã€{{rlt|emplace}}ã€{{rlt|erase}}ã€{{rlt|insert}}ã€{{rlt|insert_range}}ã€{{rlt|pop_back}}ã€{{rlt|resize}} ä»¥åŠ {{rlt|swap}}ã€‚

è¿™äº›æˆå‘˜å‡½æ•°ä»…ä¼šæ½œåœ¨åœ°ä½¿ {{rlt|end}} è¿­ä»£å™¨å¤±æ•ˆï¼š
{{rlt|append_range}}ã€{{rlt|emplace_back}}ã€{{rlt|push_back}}ã€{{rlt|try_append_range}}ã€{{rlt|try_emplace_back}}ã€{{rlt|try_push_back}}ã€{{rlt|unchecked_emplace_back}} ä»¥åŠ {{rlt|unchecked_push_back}}ã€‚

===æ¨¡æ¿å½¢å‚===
{{par begin}}
{{par|T|å…ƒç´ çš„ç±»å‹ã€‚å¿…é¡»æ»¡è¶³{{named req|MoveConstructible}}å’Œ{{named req|MoveAssignable}}ã€‚}}
{{par|N|å®¹é‡ï¼Œå³ {{tt|inplace_vector}} ä¸­å…ƒç´ çš„æœ€å¤§æ•°é‡ï¼ˆå¯èƒ½ä¸º {{c|0}}ï¼‰ã€‚}}
{{par end}}

===æˆå‘˜ç±»å‹===
{{dsc begin}}
{{dsc hitem|ç±»å‹|å®šä¹‰}}
{{dsc inc|cpp/container/dsc value_type|inplace_vector}}
{{dsc inc|cpp/container/dsc size_type|inplace_vector}}
{{dsc inc|cpp/container/dsc difference_type|inplace_vector}}
{{dsc inc|cpp/container/dsc reference|inplace_vector}}
{{dsc inc|cpp/container/dsc const_reference|inplace_vector}}
{{dsc inc|cpp/container/dsc pointer|inplace_vector}}
{{dsc inc|cpp/container/dsc const_pointer|inplace_vector}}
{{dsc inc|cpp/container/dsc iterator|inplace_vector}}
{{dsc inc|cpp/container/dsc const_iterator|inplace_vector}}
{{dsc inc|cpp/container/dsc reverse_iterator|inplace_vector}}
{{dsc inc|cpp/container/dsc const_reverse_iterator|inplace_vector}}
{{dsc end}}

===æˆå‘˜å‡½æ•°===
{{dsc begin}}
{{dsc inc|cpp/container/dsc constructor|inplace_vector}}
{{dsc inc|cpp/container/dsc destructor|inplace_vector}}
{{dsc inc|cpp/container/dsc operator{{=}}|inplace_vector}}
{{dsc inc|cpp/container/dsc assign|inplace_vector}}
{{dsc inc|cpp/container/dsc assign_range|inplace_vector}}

{{dsc h2|å…ƒç´ è®¿é—®}}
{{dsc inc|cpp/container/dsc at|inplace_vector}}
{{dsc inc|cpp/container/dsc operator_at|inplace_vector}}
{{dsc inc|cpp/container/dsc front|inplace_vector}}
{{dsc inc|cpp/container/dsc back|inplace_vector}}
{{dsc inc|cpp/container/dsc data|inplace_vector}}

{{dsc h2|è¿­ä»£å™¨}}
{{dsc inc|cpp/container/dsc begin|inplace_vector}}
{{dsc inc|cpp/container/dsc end|inplace_vector}}
{{dsc inc|cpp/container/dsc rbegin|inplace_vector}}
{{dsc inc|cpp/container/dsc rend|inplace_vector}}

{{dsc h2|å¤§å°ä¸å®¹é‡}}
{{dsc inc|cpp/container/dsc empty|inplace_vector}}
{{dsc inc|cpp/container/dsc size|inplace_vector}}
{{dsc inc|cpp/container/dsc max_size|inplace_vector}}
{{dsc inc|cpp/container/dsc capacity|inplace_vector}}
{{dsc inc|cpp/container/dsc resize|inplace_vector}}
{{dsc inc|cpp/container/dsc reserve|inplace_vector}}
{{dsc inc|cpp/container/dsc shrink_to_fit|inplace_vector}}

{{dsc h2|ä¿®æ”¹å™¨}}
{{dsc inc|cpp/container/dsc insert|inplace_vector}}
{{dsc inc|cpp/container/dsc insert_range|inplace_vector}}
{{dsc inc|cpp/container/dsc emplace|inplace_vector}}
{{dsc inc|cpp/container/dsc emplace_back|inplace_vector}}
{{dsc inc|cpp/container/dsc try_emplace_back|inplace_vector}}
{{dsc inc|cpp/container/dsc unchecked_emplace_back|inplace_vector}}
{{dsc inc|cpp/container/dsc push_back|inplace_vector}}
{{dsc inc|cpp/container/dsc try_push_back|inplace_vector}}
{{dsc inc|cpp/container/dsc unchecked_push_back|inplace_vector}}
{{dsc inc|cpp/container/dsc pop_back|inplace_vector}}
{{dsc inc|cpp/container/dsc append_range|inplace_vector}}
{{dsc inc|cpp/container/dsc try_append_range|inplace_vector}}
{{dsc inc|cpp/container/dsc clear|inplace_vector}}
{{dsc inc|cpp/container/dsc erase|inplace_vector}}
{{dsc inc|cpp/container/dsc swap|inplace_vector}}
{{dsc end}}


===éæˆå‘˜å‡½æ•°===
{{dsc begin}}
{{dsc inc|cpp/container/dsc swap2|inplace_vector}}
{{dsc inc|cpp/container/dsc erase seq|inplace_vector}}
{{dsc inc|cpp/container/dsc operator cmp|inplace_vector}}
{{dsc end}}

===æ³¨è§£===
{{tt|inplace_vector}} çš„å…ƒç´ æ•°é‡å¯åŠ¨æ€å˜åŒ–ï¼Œæœ€å¤šåˆ°ä¸€ä¸ªå›ºå®šçš„å®¹é‡ï¼Œè¿™æ˜¯ç”±äºå„å…ƒç´ æ˜¯å­˜å‚¨åœ¨å¯¹è±¡è‡ªèº«å†…éƒ¨ï¼Œè¿™ä¸ {{lc|std::array}} ç›¸ä¼¼ã€‚ä¸è¿‡ä¸ C æ•°ç»„æˆ– {{lc|std::array}} å¿…é¡»åœ¨åˆå§‹åŒ–æ—¶æ„é€ å…¨éƒ¨å…ƒç´ ä¸åŒï¼Œå¯¹è±¡æ˜¯åœ¨æ’å…¥åˆ° {{tt|inplace_vector}} ä¹‹å†…æ—¶åˆå§‹åŒ–çš„ã€‚

{{tt|inplace_vector}} åœ¨ä¸å¸Œæœ›è¿›è¡ŒåŠ¨æ€å†…å­˜åˆ†é…çš„æƒ…å½¢ä¸­éå¸¸æœ‰ç”¨ã€‚ 

{{ftm begin|sort=1}}
{{ftm|std=C++26|value=202406L|__cpp_lib_inplace_vector|{{tt|std::inplace_vector}}: å…·æœ‰å›ºå®šå®¹é‡çš„åŸä½å­˜å‚¨çš„å¯åŠ¨æ€è°ƒæ•´å¤§å°çš„å‘é‡}}
{{ftm|std=C++26|value=202502L|__cpp_lib_constexpr_inplace_vector|{{c/core|constexpr}} {{tt|std::inplace_vector}} ç”¨äºéå¹³å‡¡å…ƒç´ ç±»å‹}}
{{ftm end}}

===ç¤ºä¾‹===
{{example
|code=
#include &lt;algorithm&gt;
#include &lt;array&gt;
#include &lt;cassert&gt;
#include &lt;inplace_vector&gt;

int main()
{
    std::inplace_vector&lt;int, 4&gt; v1{0, 1, 2};
    assert(v1.max_size() == 4);
    assert(v1.capacity() == 4);
    assert(v1.size() == 3);
    assert(std::ranges::equal(v1, std::array{0, 1, 2}));
    assert(v1[0] == 0);
    assert(v1.at(0) == 0);
    assert(v1.front() == 0);
    assert(*v1.begin() == 0);
    assert(v1.back() == 2);
    v1.push_back(3);
    assert(v1.back() == 3);
    assert(std::ranges::equal(v1, std::array{0, 1, 2, 3}));
    v1.resize(3);
    assert(std::ranges::equal(v1, std::array{0, 1, 2}));
    assert(v1.try_push_back(3) != nullptr);
    assert(v1.back() == 3);
    assert(v1.size() == 4);
    assert(v1.try_push_back(13) == nullptr); // æ²¡æœ‰ä½ç½®
    assert(v1.back() == 3);
    assert(v1.size() == 4);
    v1.clear();
    assert(v1.size() == 0);
    assert(v1.empty());
}
}}

===å‚è§===
{{dsc begin}}
{{dsc inc|cpp/container/dsc vector}}
{{dsc inc|cpp/container/dsc array}}
{{dsc inc|cpp/container/dsc deque}}
{{dsc end}}

===å¤–éƒ¨é“¾æ¥===
{{elink begin}}
{{elink|[https://godbolt.org/z/5P78aG5xE {{tt|inplace_vector}}] &amp;mdash; {{stddoc|P0843R14}} ({{tt|std::inplace_vector}}) çš„ä¸€ä¸ªå‚è€ƒå®ç°ã€‚}}
{{elink|[https://www.boost.org/doc/libs/release/doc/html/container/non_standard_containers.html#container.non_standard_containers.static_vector {{tt|static_vector}}] &amp;mdash; Boost.Container å°† inplace vector å®ç°ä¸ºä¸€ä¸ªå…·æœ‰è‡ªå·±çš„ä¿è¯çš„ç‹¬ç«‹ç±»å‹ã€‚}}
{{elink|[https://github.com/questor/eastl/blob/master/fixed_vector.h#L71 {{tt|fixed_vector}}] &amp;mdash; EASTL é€šè¿‡ä¸€ä¸ªé¢å¤–çš„æ¨¡æ¿å‚æ•°å®ç° inplace vectorã€‚}}
{{elink|[https://github.com/facebook/folly/blob/master/folly/docs/small_vector.md {{tt|small_vector}}] &amp;mdash; Folly ä¹Ÿé€šè¿‡ä¸€ä¸ªé¢å¤–çš„æ¨¡æ¿å‚æ•°å®ç° inplace vectorã€‚}}
{{elink|[https://howardhinnant.github.io/stack_alloc.html {{tt|stack_alloc}}] &amp;mdash; Howard Hinnant åœ¨ {{lc|std::vector}} ä¸Šæ¨¡æ‹Ÿ {{tt|std::inplace_vector}} çš„è‡ªå®šä¹‰åˆ†é…å™¨ã€‚}}
{{elink end}}

{{langlinks|de|en|es|fr|it|ja|pl|pt|ru}}