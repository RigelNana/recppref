{{cpp/locale/codecvt/title|unshift, do_unshift}}
{{cpp/locale/codecvt/navbar}}
{{dcl begin}}
{{dcl header|locale}}
{{dcl|num=1|1=
public:
result unshift( StateT&amp; state, ExternT* to, ExternT* to_end,
                ExternT*&amp; to_next ) const;
}}
{{dcl|num=2|1=
protected:
virtual result do_unshift( StateT&amp; state, ExternT* to, ExternT* to_end,
                           ExternT*&amp; to_next ) const;
}}
{{dcl end}}

@1@ Public member function, calls the member function {{tt|do_unshift}} of the most derived class.

@2@ If the encoding represented by this {{tt|codecvt}} facet is state-dependent, and {{c|state}} represents a conversion state that is not the initial shift state, writes the characters necessary to return to the initial shift state. The characters are written to a character array whose first element is pointed to by {{c|to}}. No more than {{c|to_end - to}} characters are written. The parameter {{c|to_next}} is updated to point one past the last character written.

===Return value===
A value of type {{lc|std::codecvt_base::result}}, indicating the success status as follows:
{{dsc begin}}
{{dsc|{{tt|ok}}|all necessary characters were written. {{c|state}} now represents initial shift state}}
{{dsc|{{tt|partial}}|not enough space in the output buffer. {{c|1=to_next == to_end}}}}
{{dsc|{{tt|error}}|an unspecified error has occurred}}
{{dsc|{{tt|noconv}}|the encoding is not state-dependent, no termination sequence necessary}}
{{dsc end}}

===Notes===
This function is called by {{lc|std::basic_filebuf::close()}} and in other situations when finalizing a state-dependent multibyte character sequence.

===Example===
{{example
|
|code=
|output=
}}

===Defect reports===
{{dr list begin}}
{{dr list item|wg=lwg|dr=305|std=C++98|before={{c/core|std::codecvt&lt;wchar_t, char, std::mbstate_t&gt;::do_unshift}}&lt;br&gt;was required not to write any character|after=not required}}
{{dr list item|wg=lwg|dr=380|std=C++98|before=the meaning of returning {{c|partial}} was 'more characters need to&lt;br&gt;be supplied to complete termination', but no character is supplied|after=corrected to indicating&lt;br&gt;insufficient buffer space}}
{{dr list item|wg=lwg|dr=381|std=C++98|before={{c|state}} was not required to be valid, and&lt;br&gt;{{c|error}} is returned if {{c|state}} is invalid|after={{c|state}} is required to be valid, and&lt;br&gt;returning {{c|error}} indicates an error}}
{{dr list item|wg=lwg|dr=664|std=C++98|before={{c/core|std::codecvt&lt;char, char, std::mbstate_t&gt;::do_unshift}}&lt;br&gt;was required not to write any character|after=not required}}
{{dr list item|wg=lwg|dr=665|std=C++98|before={{c/core|std::codecvt&lt;char, char, std::mbstate_t&gt;::do_unshift}}&lt;br&gt;was required to return {{c|noconv}}|after=not required}}
{{dr list end}}

===See also===
{{dsc begin}}
{{dsc inc|cpp/string/multibyte/dsc wcrtomb}}
{{dsc inc|cpp/locale/codecvt/dsc do_out}}
{{dsc end}}

{{langlinks|de|es|fr|it|ja|pt|ru|zh}}