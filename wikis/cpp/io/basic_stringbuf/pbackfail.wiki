{{cpp/io/basic_stringbuf/title | pbackfail }}
{{cpp/io/basic_stringbuf/navbar}}
{{ddcl |1=
protected:
virtual int_type pbackfail( int_type c = Traits::eof() )
}}

This protected virtual function is called by the public functions {{l2tt|cpp/io/basic_streambuf/sungetc}} and {{l2tt|cpp/io/basic_streambuf/sputbackc}} (which, in turn, are called by {{l2tt|cpp/io/basic_istream/unget}} and {{l2tt|cpp/io/basic_istream/putback}}). 

@1@ The caller is requesting that the get area is backed up by one character ({{tt|pbackfail()}} is called with no arguments or with {{c|Traits::eof()}} as the argument)
:@a@ First, checks if there is a putback position, and if there really isn't, fails. (stringbuf has no external character source to re-read)
:@b@ If the caller was wrong and the putback position is in fact available, simply decrements {{l2tt|cpp/io/basic_streambuf/gptr|gptr()}}, e.g. by calling {{c|gbump(-1)}}. 
@2@ The caller attempts to putback a different character from the one retrieved earlier ({{tt|pbackfail()}} is called with the character that needs to be put back), in which case
:@a@ First, checks if there is a putback position, and if there isn't, fails.
:@b@ Then checks what character is in the putback position. If the character held there is already equal to {{tt|c}}, as determined by {{c|Traits::eq(to_char_type(c), gptr()[-1])}}, then simply decrements {{l2tt|cpp/io/basic_streambuf/gptr|gptr()}}.
:@c@ Otherwise, if the buffer is open for reading only, fails.
:@d@ Otherwise, if the buffer is open for writing ({{c|mode &amp;&amp; std::ios_base::out}} is nonzero), then decrements {{l2tt|cpp/io/basic_streambuf/gptr|gptr()}} and writes {{tt|c}} to the location pointed to gptr() after adjustment.

===Parameters===
{{par begin}}
{{par | c | the character to put back, or Traits::eof() to indicate that backing up of the get area is requested}}
{{par end}}

===Return value===
{{c|c}} on success except if {{tt|c}} was {{c|Traits::eof()}}, in which case {{c|Traits::not_eof(c)}} is returned.

{{c|Traits::eof()}} on failure.

===Example===
{{example
 |
 | code=
 | output=
}}

===See also===
{{dsc begin}}
{{dsc inc | cpp/io/basic_streambuf/dsc pbackfail}}
{{dsc inc | cpp/io/basic_streambuf/dsc sungetc}}
{{dsc inc | cpp/io/basic_streambuf/dsc sputbackc}}
{{dsc inc | cpp/io/basic_istream/dsc unget}}
{{dsc inc | cpp/io/basic_istream/dsc putback}}
{{dsc end}}

{{langlinks|ja|zh}}