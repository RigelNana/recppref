{{cpp/io/basic_streambuf/title|pbackfail}}
{{cpp/io/basic_streambuf/navbar}}
{{dcl begin}}
{{dcl|1=
protected:
virtual int_type pbackfail( int_type c = Traits::eof() );
}}
{{dcl end}}

This function can only be called if any of the following condition is satisfied:
* {{c|gptr()}} is [[cpp/language/pointer#Null pointers|null]],
* {{c|1=gptr() == eback()}}, or
* {{c|traits::eq(traits::to_char_type(c), gptr()[-1])}} returns {{c|false}}.

This function is called by the public functions {{lc|sungetc()}} and {{lc|sputbackc()}} (which, in turn, are called by {{l2tt|cpp/io/basic_istream/unget}} and {{l2tt|cpp/io/basic_istream/putback}}) when either:
@1@ There is no putback position in the get area ({{tt|pbackfail()}} is called with no arguments). In this situation, the purpose of {{tt|pbackfail()}} is to back up the get area by one character, if the associated character sequence allows this (e.g. a file-backed streambuf may reload the buffer from a file, starting one character earlier). 
@2@ The caller attempts to putback a different character from the one retrieved earlier ({{tt|pbackfail()}} is called with the character that needs to be put back). In this situation, the purpose of {{tt|pbackfail()}} is to place the character {{tt|c}} into the get area at the position just before {{l2tt|cpp/io/basic_streambuf/gptr|gptr()}}, and, if possible, to modify the associated character sequence to reflect this change. This may involve backing up the get area as in the first variant.

The default base class version of this function does nothing and returns {{c|Traits::eof()}} in all situations. This function is overridden by the derived classes: {{l2tt|cpp/io/basic_stringbuf/pbackfail}}, {{l2tt|cpp/io/basic_filebuf/pbackfail}}, {{l2tt|cpp/io/strstreambuf/pbackfail}}, and is expected to be overridden by user-defined and third-party library stream classes.

===Parameters===
{{par begin}}
{{par|ch|character to put back or {{c|Traits::eof()}} if only back out is requested}}
{{par end}}

===Return value===
{{c|Traits::eof()}} in case of failure, some other value to indicate success. The base class version always fails.

===Example===
{{example|
|code=
|output=
}}

===Defect reports===
{{dr list begin}}
{{dr list item|wg=lwg|dr=32|std=C++98|before=the calling condition '{{c|traits::eq(*gptr(),traits::to_char_type(c))}}&lt;br&gt;returns {{c|false}}' did not match the description of {{lc|sputbackc()}}|after=corrected to match&lt;br&gt;the description}}
{{dr list end}}

===See also===
{{dsc begin}}
{{dsc inc|cpp/io/basic_filebuf/dsc pbackfail}}
{{dsc inc|cpp/io/basic_stringbuf/dsc pbackfail}}
{{dsc inc|cpp/io/strstreambuf/dsc pbackfail}}
{{dsc inc|cpp/io/basic_streambuf/dsc sungetc}}
{{dsc inc|cpp/io/basic_streambuf/dsc sputbackc}}
{{dsc end}}

{{langlinks|de|es|fr|it|ja|pt|ru|zh}}