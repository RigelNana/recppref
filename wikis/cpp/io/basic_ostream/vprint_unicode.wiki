{{cpp/title|vprint_unicode{{small|(std::ostream)}}}}
{{cpp/io/basic_ostream/navbar}}
{{ddcl|header=ostream|since=c++23|
void vprint_unicode( std::ostream&amp; os,
                     std::string_view fmt, std::format_args args );
}}

Format {{c|args}} according to the format string {{c|fmt}}, and writes the result to the output stream {{c|os}}. Behaves as {{named req|FormattedOutputFunction}} of {{c|os}}, except that some details of error reporting [[#Exceptions|differ]].

Performs the following operations in order:
# First, the function constructs and checks the {{rlp|sentry}} object.
# Initializes an automatic variable as if by {{c|1=std::string out = std::vformat(os.getloc(), fmt, args);}}.
# Writes {{c|out}} to {{c|os}}:
:* If {{c|os}} refers to a terminal that is only capable of displaying Unicode via a [[cpp/io/vprint_unicode#Notes|native Unicode API]], flushes {{c|os}} and writes {{c|out}} to the terminal using the native Unicode API.
:* Otherwise, inserts the character sequence {{range|out.begin()|out.end()}} into {{c|os}}.

If writing to the terminal or inserting into {{c|os}} fails, calls {{c|os.setstate(std::ios_base::badbit)}}.

If {{c|out}} contains invalid Unicode {{enwiki|Character encoding#Terminology|code units}} when the native Unicode API is used, the behavior is undefined.

===Parameters===
{{par begin}}
{{par|os|output stream to insert data into}}
{{par|fmt|{{include|cpp/utility/format/format string}}}}
{{par|args|arguments to be formatted}}
{{par end}}

===Exceptions===
{{std print ostream exceptions}}

===Notes===
If invoking the native Unicode API requires transcoding, the invalid code units are substituted with {{tt|U+FFFD}} REPLACEMENT CHARACTER (see "The Unicode Standard - Core Specification", [[#External links|Chapter 3.9]]).

{{ftm begin|std=1|value=1|comment=1}}
{{ftm|std=C++23|value=202207L|__cpp_lib_print|Formatted output}}
{{ftm|std=C++23|value=202207L|__cpp_lib_format|Exposing {{lc|std::basic_format_string}}}}
{{ftm end}}

===Example===
{{example
|code=
|output=
}}

===Defect reports===
{{dr list begin}}
{{dr list item|wg=lwg|dr=4044|std=C++23|before=the native Unicode API was always used if the&lt;br&gt;terminal referred to by {{c|os}} can display Unicode|after=only used if the terminal can only use&lt;br&gt;the native Unicode API to display Unicode}}
{{dr list end}}

===See also===
{{dsc begin}}
{{dsc inc|cpp/io/basic_ostream/dsc vprint_nonunicode}}
{{dsc inc|cpp/io/basic_ostream/dsc print}}
{{dsc inc|cpp/io/basic_ostream/dsc operator ltlt2}}
{{dsc inc|cpp/io/dsc vprint_unicode}}
{{dsc inc|cpp/utility/format/dsc format}}
{{dsc end}}

===External links===
{{elink begin}}
{{elink|{{enwiki|Unicode|Unicode}}}}
{{elink|[https://www.unicode.org/versions/Unicode14.0.0/UnicodeStandard-14.0.pdf The Unicode Standard Version 14.0 - Core Specification]}}
{{elink end}}

{{langlinks|de|es|fr|ja|ru|zh}}